<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>June Viewership Insights Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
    <!-- Chart.js Floating Bar Controller for Volatility Chart -->
    <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-box-and-violin@4.0.0/dist/chartjs-chart-box-and-violin.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutrals -->
    <!-- Application Structure Plan: The SPA now uses a tabbed navigation system at the very top to switch between major content views: "Monthly Highlights" (containing KPIs, Daily Viewership, and Overall Analysis, and Strategic Recommendations, "Top 10 Titles", and "Recommendation Titles". This approach maintains the single-page constraint while simulating "page" navigation. Each major view is a distinct HTML section that is shown or hidden via JavaScript. This enhances user flow by allowing them to jump directly to specific report areas. -->
    <!-- Visualization & Content Choices: 1. KPI Cards (Highest/Lowest/Avg Views): Goal: Inform. Method: Styled HTML/Tailwind. Interaction: Static. Justification: Provides immediate, high-level context. 2. Average Views (Overall): Goal: Compare. Method: Bar Chart. Interaction: Hover tooltips, click to highlight recommendation. Justification: Best for comparing discrete categories (days) across the entire dataset. Library: Chart.js. 3. Viewership Volatility (Overall): Goal: Show Range. Method: Floating Bar Chart. Interaction: Hover tooltips, click to highlight. Justification: Clearly visualizes data spread and volatility for each day across the entire dataset. Library: Chart.js. 4. Daily Views by Week: Goal: Track Change/Inform. Method: Bar Chart. Interaction: Weekly tabs to filter data, hover tooltips, click to highlight. Justification: Allows granular daily inspection within specific weekly contexts. Chart is initially hidden and appears on tab click. Library: Chart.js. 5. Recommendations: Goal: Advise. Method: HTML/JS Accordion. Interaction: Click to expand/collapse. Justification: Organizes detailed text, reduces cognitive load, and links interactively to charts. 6. Top 10 Titles Views Chart: Goal: Compare. Method: Bar Chart. Interaction: Hover tooltips, click to filter from table. Justification: Visually compares viewership across top titles and allows drill-down. Library: Chart.js. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* slate-50 */
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 400px;
        }
        @media (max-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        @media (max-width: 640px) {
            .chart-container {
                height: 300px;
            }
        }
        .highlight {
            transition: all 0.3s ease-in-out;
            animation: pulse 1.5s ease-in-out;
        }
        @keyframes pulse {
            0% { background-color: #e0f2fe; transform: scale(1); } /* sky-100 */
            50% { background-color: #e0f2fe; transform: scale(1.01); }
            100% { background-color: transparent; transform: scale(1); }
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-in-out;
        }
        .accordion-header {
            transition: background-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        /* Custom styling for table rows */
        #topTitlesTableBody tr:nth-child(odd) {
            background-color: #f8fafc; /* slate-50 */
        }
        #topTitlesTableBody tr:hover {
            background-color: #f1f5f9; /* slate-100 */
            transition: background-color 0.2s ease-in-out;
            cursor: pointer; /* Indicate clickable rows */
        }
        /* Styles for the dropdown menu items */
        .dropdown-menu-item {
            display: block; /* Make links take full width */
            padding: 0.5rem 1rem; /* py-2 px-4 */
            cursor: pointer;
            white-space: nowrap; /* Prevent wrapping */
            transition: background-color 0.2s ease-in-out;
            text-decoration: none; /* Remove underline from links */
            color: #1f2937; /* slate-800 equivalent for text */
        }
        .dropdown-menu-item:hover {
            background-color: #f1f5f9; /* slate-100 */
        }

        /* Styles for the Clip Performance Analysis page */
        .clip-performance-header {
            background-color: #005f73;
            color: white;
            padding: 3rem 1rem;
            text-align: center;
        }
        .clip-performance-header h1 {
            font-size: 2.25rem; /* text-4xl */
            font-weight: 700; /* font-bold */
        }
        .clip-performance-header p {
            margin-top: 1rem;
            font-size: 1.125rem; /* text-lg */
            color: #e2e8f0; /* gray-200 */
        }
        @media (min-width: 768px) {
            .clip-performance-header h1 {
                font-size: 3rem; /* md:text-5xl */
            }
            .clip-performance-header p {
                font-size: 1.25rem; /* md:text-xl */
            }
        }
        .clip-performance-section-title {
            font-size: 1.875rem; /* text-3xl */
            font-weight: 700; /* font-bold */
            text-align: center;
            color: #005f73;
            margin-bottom: 2rem;
        }
        .kpi-card {
            background-color: white;
            padding: 1.5rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            text-align: center;
        }
        .kpi-card p:first-child {
            font-size: 3rem; /* text-5xl */
            font-weight: 800; /* font-extrabold */
        }
        .kpi-card p:last-child {
            margin-top: 0.5rem;
            font-size: 1.125rem; /* text-lg */
            font-weight: 500; /* font-medium */
            color: #4b5563; /* gray-600 */
        }
        .kpi-card.total-profiles p:first-child { color: #0a9396; }
        .kpi-card.total-clips p:first-child { color: #ee9b00; }
        .kpi-card.total-views p:first-child { color: #ae2012; }

        .recommendation-card {
            background-color: white;
            padding: 1.5rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            border-left-width: 4px;
        }
        .recommendation-card h3 {
            font-weight: 700; /* font-bold */
            font-size: 1.125rem; /* text-lg */
            margin-bottom: 0.5rem;
            color: #005f73;
        }
        .recommendation-card p {
            color: #4b5563; /* gray-600 */
        }
        .recommendation-card.blue-border { border-left-color: #0a9396; }
        .recommendation-card.yellow-border { border-left-color: #ee9b00; }
        .recommendation-card.red-border { border-left-color: #ae2012; }

        .clip-performance-footer {
            text-align: center;
            padding: 1.5rem;
            margin-top: 3rem;
            background-color: #005f73;
            color: #d1d5db; /* gray-300 */
        }
        .clip-performance-footer p {
            margin-bottom: 0.5rem;
        }
        .clip-performance-footer a {
            margin-top: 1rem;
            display: inline-block;
            padding: 0.5rem 1.5rem;
            background-color: #0ea5e9; /* sky-600 */
            color: white;
            border-radius: 0.375rem; /* rounded-md */
            box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05); /* shadow-sm */
            transition: background-color 0.2s ease-in-out;
        }
        .clip-performance-footer a:hover {
            background-color: #0284c7; /* sky-700 */
        }

        /* Modal specific styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        }

        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background-color: white;
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            width: 90%;
            max-width: 600px;
            transform: translateY(-20px);
            opacity: 0;
            transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out;
            position: relative; /* For close button positioning */
        }

        .modal-overlay.show .modal-content {
            transform: translateY(0);
            opacity: 1;
        }

        .modal-close-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #4b5563; /* gray-600 */
            transition: color 0.2s ease-in-out;
        }

        .modal-close-btn:hover {
            color: #1f2937; /* gray-900 */
        }

        .modal-table-container {
            max-height: 400px; /* Limit height for scrollability */
            overflow-y: auto;
            margin-top: 1rem;
            border: 1px solid #e2e8f0; /* slate-200 */
            border-radius: 0.5rem;
        }

        .modal-table {
            width: 100%;
            border-collapse: collapse;
        }

        .modal-table th, .modal-table td {
            padding: 0.75rem 1rem;
            text-align: left;
            border-bottom: 1px solid #e2e8f0; /* slate-200 */
        }

        .modal-table thead {
            background-color: #f1f5f9; /* slate-100 */
            position: sticky;
            top: 0;
            z-index: 10; /* Ensure header stays on top when scrolling */
        }

        .modal-table th {
            font-size: 0.75rem; /* text-xs */
            font-weight: 600; /* font-semibold */
            text-transform: uppercase;
            color: #475569; /* slate-600 */
        }

        .modal-table tbody tr:nth-child(odd) {
            background-color: #f8fafc; /* slate-50 */
        }

        .modal-table tbody tr:hover {
            background-color: #e2e8f0; /* slate-200 */
        }

        /* Temporary message style */
        #debugMessage {
            position: fixed;
            top: 1rem;
            right: 1rem;
            background-color: #fefcbf; /* yellow-100 */
            color: #854d0c; /* yellow-800 */
            padding: 0.75rem 1.25rem;
            border-radius: 0.5rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            z-index: 1001;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            pointer-events: none; /* Allow clicks to pass through */
        }
        #debugMessage.show {
            opacity: 1;
        }
    </style>
</head>
<body class="text-slate-800">

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">

        <!-- New Top-Level Report Navigation -->
        <nav class="mb-8 md:mb-12">
            <div class="inline-flex bg-slate-100 p-1 rounded-lg text-sm flex-wrap justify-center gap-2 w-full">
                <button id="juneReportBtn" class="px-4 py-2 rounded-md bg-sky-600 text-white shadow-sm font-semibold report-nav-btn" data-target="june-report-content">June Performance Analysis</button>
                <button id="julyReportBtn" class="px-4 py-2 rounded-md bg-slate-200 text-slate-800 font-medium report-nav-btn hover:bg-slate-300" data-target="july-report-content">July Performance Analysis</button>
                
                <!-- DMCS Views with Hover Dropdown -->
                <div class="relative group">
                    <button id="dmcsViewsBtn" class="px-4 py-2 rounded-md bg-slate-200 text-slate-800 font-medium report-nav-btn hover:bg-slate-300" data-target="dmcs-views-content">DMCS Views</button>
                    <div class="absolute hidden group-hover:block bg-white shadow-lg rounded-md mt-1 z-10 min-w-[120px] overflow-hidden">
                        <a href="#" class="dropdown-menu-item" data-target-section="dmcs-june-content">June</a>
                        <a href="#" class="dropdown-menu-item" data-target-section="dmcs-july-content">July</a>
                    </div>
                </div>

                <!-- Third Party Views button now navigates to an overview page section -->
                <button id="thirdPartyViewsBtn" class="px-4 py-2 rounded-md bg-slate-200 text-slate-800 font-medium report-nav-btn hover:bg-slate-300" data-target="third-party-overview-section">Third Party Views</button>

                <button id="additionalInsightsBtn" class="px-4 py-2 rounded-md bg-slate-200 text-slate-800 font-medium report-nav-btn hover:bg-slate-300" data-target="additional-insights-content">Additional Insights</button>
            </div>
        </nav>

        <!-- Main Content Area - Each section corresponds to a top-level nav button -->
        <div id="june-report-content" class="report-content-section">
            <header class="text-center mb-8 md:mb-12">
                <h1 class="text-3xl md:text-4xl font-bold text-slate-900">June Viewership Performance Analysis</h1>
                <p class="mt-2 text-lg text-slate-600">Uncovering Key Trends & Strategic Opportunities</p>
            </header>

            <!-- Top-level Navigation Tabs (Dashboard, Top 10 Titles, Recommendation Titles) -->
            <nav class="mb-8 md:mb-12">
                <div class="inline-flex bg-slate-100 p-1 rounded-lg text-sm flex-wrap justify-center gap-2 w-full">
                    <button id="dashboardTabBtn" class="px-4 py-2 rounded-md bg-white text-sky-600 shadow-sm font-semibold main-tab-btn" data-target="dashboard-section">Monthly Highlights</button>
                    <button id="topTitlesTabBtn" class="px-4 py-2 rounded-md text-slate-600 font-medium main-tab-btn" data-target="top-titles-section">Top 10 Titles Views</button>
                    <button id="recommendationTitlesTabBtn" class="px-4 py-2 rounded-md text-slate-600 font-medium main-tab-btn" data-target="recommendation-titles-section">Recommendation Titles</button>
                </div>
            </nav>

            <main>
                <!-- Dashboard Section (Default View) -->
                <section id="dashboard-section" class="main-content-section">
                    <!-- Key Metrics Section -->
                    <section id="kpis" class="mb-8 md:mb-12">
                        <h2 class="text-2xl font-semibold text-slate-900 mb-4 text-center">Monthly Highlights</h2>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-6 text-center">
                            <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200">
                                <p class="text-sm font-medium text-slate-500">Highest Viewership</p>
                                <p id="kpiHighest" class="text-3xl font-bold text-sky-600 mt-1">859K</p>
                                <p id="kpiHighestDay" class="text-xs text-slate-400">on a Friday</p>
                            </div>
                            <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200">
                                <p class="text-sm font-medium text-slate-500">Lowest Viewership</p>
                                <p id="kpiLowest" class="text-3xl font-bold text-amber-600 mt-1">433K</p>
                                <p id="kpiLowestDay" class="text-xs text-slate-400">on a Sunday</p>
                            </div>
                            <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200">
                                <p class="text-sm font-medium text-slate-500">Avg. Mid-Week Views</p>
                                <p id="kpiMidWeekAvg" class="text-3xl font-bold text-slate-700 mt-1">771K</p>
                                <p class="text-xs text-slate-400">(Tue-Thu)</p>
                            </div>
                            <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200">
                                <p class="text-sm font-medium text-slate-500">Avg. Weekend Views</p>
                                <p id="kpiWeekendAvg" class="text-3xl font-bold text-slate-700 mt-1">663K</p>
                                <p class="text-xs text-slate-400">(Sat-Sun)</p>
                            </div>
                        </div>
                    </section>

                    <!-- Daily Viewership by Week Section -->
                    <section id="weeklyDailyViewsSection" class="bg-white p-4 sm:p-6 rounded-xl shadow-sm border border-slate-200 mb-8 md:mb-12">
                        <div class="text-center mb-6">
                            <h2 class="text-2xl font-semibold text-slate-900">Daily Viewership by Week</h2>
                            <p class="text-slate-600 mt-1">Click a week to see daily view trends for that period.</p>
                            <div class="mt-4 inline-flex bg-slate-100 p-1 rounded-lg text-sm flex-wrap justify-center gap-2">
                                <button id="week1DailyBtn" class="px-4 py-1.5 rounded-md text-slate-600 font-medium weekly-daily-btn">Week 1</button>
                                <button id="week2DailyBtn" class="px-4 py-1.5 rounded-md text-slate-600 font-medium weekly-daily-btn">Week 2</button>
                                <button id="week3DailyBtn" class="px-4 py-1.5 rounded-md text-slate-600 font-medium weekly-daily-btn">Week 3</button>
                                <button id="week4DailyBtn" class="px-4 py-1.5 rounded-md text-slate-600 font-medium weekly-daily-btn">Week 4</button>
                            </div>
                        </div>
                        <div id="dailyChartContainer" class="chart-container hidden">
                            <canvas id="dailyViewsChart"></canvas>
                        </div>
                    </section>

                    <!-- Overall Interactive Chart Section -->
                    <section id="charts" class="bg-white p-4 sm:p-6 rounded-xl shadow-sm border border-slate-200 mb-8 md:mb-12">
                        <div class="text-center mb-6">
                            <h2 class="text-2xl font-semibold text-slate-900">Overall Weekly Performance Analysis</h2>
                            <p class="text-slate-600 mt-1">Compare average performance and volatility across the entire month.</p>
                            <div class="mt-4 inline-flex bg-slate-100 p-1 rounded-lg text-sm">
                                <button id="avgBtn" class="px-4 py-1.5 rounded-md bg-white text-sky-600 shadow-sm font-semibold chart-type-btn">Average Performance</button>
                                <button id="rangeBtn" class="px-4 py-1.5 rounded-md text-slate-600 font-medium chart-type-btn">Volatility Analysis</button>
                            </div>
                        </div>

                        <div id="avgChartContainer" class="chart-container">
                            <canvas id="averageViewsChart"></canvas>
                        </div>
                        <div id="rangeChartContainer" class="chart-container hidden">
                            <canvas id="rangeViewsChart"></canvas>
                        </div>
                    </section>

                    <!-- Strategic Recommendations Section (Now part of Monthly Highlights) -->
                    <section id="recommendations">
                        <h2 class="text-2xl font-semibold text-slate-900 mb-4 text-center">Strategic Recommendations</h2>
                        <div class="space-y-3 max-w-4xl mx-auto">
                            <div class="accordion-item bg-white rounded-xl shadow-sm border border-slate-200" data-day="Thursday,Tuesday,Wednesday">
                                <button class="accordion-header w-full flex justify-between items-center text-left p-4 font-semibold text-slate-800 hover:bg-slate-50 hover:shadow-md">
                                    Leverage Mid-Week Dominance
                                    <span class="transform transition-transform duration-300">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
                                    </span>
                                </button>
                                <div class="accordion-content">
                                    <div class="p-4 pt-0 text-slate-600">
                                        <ul class="list-disc pl-5 space-y-1">
                                            <li>Prioritize high-impact content and major announcements on these days.</li>
                                            <li>Schedule primary marketing pushes to align with peak mid-week engagement.</li>
                                            <li>Maximize reach and viewership by focusing efforts where the audience is most active.</li>
                                        </ul>
                                        <button class="mt-4 px-4 py-2 bg-purple-600 text-white rounded-md shadow-sm hover:bg-purple-700 transition-colors duration-200 elaborate-btn">✨ Elaborate</button>
                                        <div class="llm-response mt-4 p-3 bg-slate-50 rounded-md border border-slate-200 hidden">
                                            <div class="loading-spinner flex items-center justify-center hidden">
                                                <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-purple-500"></div>
                                                <span class="ml-2 text-slate-500">Generating insights...</span>
                                            </div>
                                            <p class="generated-text text-sm leading-relaxed"></p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="accordion-item bg-white rounded-xl shadow-sm border border-slate-200" data-day="Saturday,Sunday">
                                <button class="accordion-header w-full flex justify-between items-center text-left p-4 font-semibold text-slate-800 hover:bg-slate-50 hover:shadow-md">
                                    Optimize Weekend Strategy
                                    <span class="transform transition-transform duration-300">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
                                    </span>
                                </button>
                                <div class="accordion-content">
                                    <div class="p-4 pt-0 text-slate-600">
                                        <ul class="list-disc pl-5 space-y-1">
                                            <li>Experiment with different content formats or themes, suchs as "evergreen" or "lean-back" content.</li>
                                            <li>Align content with typical weekend audience behavior (e.g., relaxation, entertainment).</li>
                                            <li>Consider A/B testing post times to find optimal engagement windows on weekends.</li>
                                        </ul>
                                        <button class="mt-4 px-4 py-2 bg-purple-600 text-white rounded-md shadow-sm hover:bg-purple-700 transition-colors duration-200 elaborate-btn">✨ Elaborate</button>
                                        <div class="llm-response mt-4 p-3 bg-slate-50 rounded-md border border-slate-200 hidden">
                                            <div class="loading-spinner flex items-center justify-center hidden">
                                                <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-purple-500"></div>
                                                <span class="ml-2 text-slate-500">Generating insights...</span>
                                            </div>
                                            <p class="generated-text text-sm leading-relaxed"></p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="accordion-item bg-white rounded-xl shadow-sm border border-slate-200" data-day="Friday">
                                <button class="accordion-header w-full flex justify-between items-center text-left p-4 font-semibold text-slate-800 hover:bg-slate-50 hover:shadow-md">
                                    Decipher Friday's Volatility
                                    <span class="transform transition-transform duration-300">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
                                    </span>
                                </button>
                                <div class="accordion-content">
                                    <div class="p-4 pt-0 text-slate-600">
                                        <ul class="list-disc pl-5 space-y-1">
                                            <li>Conduct a deep dive into factors that drove the $859K$ peak on a Friday.</li>
                                            <li>Identify specific content, promotional strategies, or external events contributing to success.</li>
                                            <li>Develop strategies to replicate high performance and mitigate low-performing Fridays.</li>
                                        </ul>
                                        <button class="mt-4 px-4 py-2 bg-purple-600 text-white rounded-md shadow-sm hover:bg-purple-700 transition-colors duration-200 elaborate-btn">✨ Elaborate</button>
                                        <div class="llm-response mt-4 p-3 bg-slate-50 rounded-md border border-slate-200 hidden">
                                            <div class="loading-spinner flex items-center justify-center hidden">
                                                <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-purple-500"></div>
                                                <span class="ml-2 text-slate-500">Generating insights...</span>
                                            </div>
                                            <p class="generated-text text-sm leading-relaxed"></p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </main>
            </div>

            <!-- Top 10 Titles Section (Initially Hidden) -->
            <section id="top-titles-section" class="report-content-section hidden">
                <div class="bg-white p-4 sm:p-6 rounded-xl shadow-sm border border-slate-200 mb-8 md:mb-12">
                    <h2 class="text-2xl font-semibold text-slate-900 mb-4 text-center">Top 10 Titles Views (June)</h2>
                    <p class="text-slate-600 mb-6 text-center">Here are the top 10 performing titles based on viewership data for June:</p>
                    <div class="overflow-x-auto mb-8"> <!-- Added mb-8 for space -->
                        <table class="min-w-full rounded-lg overflow-hidden shadow-sm border border-slate-200">
                            <thead class="bg-slate-100 border-b border-slate-200">
                                <tr>
                                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider">Rank</th>
                                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider">Title Name</th>
                                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider">Total Views</th>
                                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider">Total Likes</th>
                                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider">Avg. Views Per Clip</th>
                                </tr>
                            </thead>
                            <tbody id="topTitlesTableBody" class="divide-y divide-slate-200 text-sm text-slate-700">
                                <!-- Data will be inserted here by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                    <div class="chart-container">
                        <canvas id="topTitlesViewsChart"></canvas>
                    </div>
                    <div class="text-center mt-4">
                        <button id="showAllTitlesBtn" class="px-4 py-2 rounded-md bg-sky-600 text-white shadow-sm font-semibold hover:bg-sky-700 transition-colors duration-200">Show All Titles</button>
                    </div>
                </div>
            </section>

            <!-- Recommendation Titles Section (Initially Hidden) -->
            <section id="recommendation-titles-section" class="report-content-section hidden">
                <div class="bg-white p-4 sm:p-6 rounded-xl shadow-sm border border-slate-200 mb-8 md:mb-12">
                    <h2 class="text-2xl font-semibold text-slate-900 mb-4 text-center">Recommendation Titles for July</h2>
                    <p class="text-slate-600 mb-6 text-center">Based on June's viewership trends and average performance, here are some recommended title categories or themes to focus on for July to potentially maximize engagement.</p>
                    <ul class="list-disc pl-8 space-y-3 text-slate-700">
                        <li>**Mid-Week Boosters:** Content designed for high engagement on Tuesdays, Wednesdays, and Thursdays.
                            <ul class="list-circle pl-5 text-slate-600">
                                <li>*Example:* "Deep Dive: Advanced Analytics Strategies" (for a Tuesday release)</li>
                                <li>*Example:* "Webinar Series: Mastering Digital Marketing" (for a Wednesday slot)</li>
                            </ul>
                        </li>
                        <li>**Weekend Engagement:** Lighter, more evergreen, or community-focused content for Saturdays and Sundays.
                            <ul class="list-circle pl-5 text-slate-600">
                                <li>*Example:* "Behind the Scenes: Our Creative Process" (Sunday feature)</li>
                                <li>*Example:* "Community Spotlight: User Success Stories" (Saturday share)</li>
                            </ul>
                        </li>
                        <li>**Friday Potential:** High-impact, potentially viral content to capture the variable but high-peak Friday audience.
                            <ul class="list-circle pl-5 text-slate-600">
                                <li>*Example:* "Exclusive Interview: Industry Leader Insights" (Friday morning drop)</li>
                                <li>*Example:* "Flash Sale Announcement: Limited Time Offer" (if applicable)</li>
                            </ul>
                        </li>
                        <li>**Trending Topics:** Titles that capitalize on current events or popular searches (requires ongoing research).
                            <ul class="list-circle pl-5 text-slate-600">
                                <li>*Example:* "Impact of AI on [Specific Industry]"</li>
                                <li>*Example:* "Decoding the Latest [Tech/Market] Trends"</li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </section>

            <!-- Placeholder sections for other top-level reports -->
            <section id="july-report-content" class="report-content-section hidden">
                <header class="text-center mb-8 md:mb-12">
                    <h1 class="text-3xl md:text-4xl font-bold text-slate-900">July Viewership Performance Analysis</h1>
                    <p class="mt-2 text-lg text-slate-600">Uncovering Key Trends & Strategic Opportunities for July</p>
                </header>

                <!-- Top-level Navigation Tabs for July (Dashboard, Top 10 Titles, Recommendation Titles) -->
                <nav class="mb-8 md:mb-12">
                    <div class="inline-flex bg-slate-100 p-1 rounded-lg text-sm flex-wrap justify-center gap-2 w-full">
                        <button id="julyDashboardTabBtn" class="px-4 py-2 rounded-md bg-white text-sky-600 shadow-sm font-semibold july-main-tab-btn" data-target="july-dashboard-section">Monthly Highlights (July)</button>
                        <button id="julyTopTitlesTabBtn" class="px-4 py-2 rounded-md text-slate-600 font-medium july-main-tab-btn" data-target="july-top-titles-section">Top Titles Views (July)</button>
                        <!-- Removed July Recommendation Titles Tab -->
                    </div>
                </nav>

                <main>
                    <!-- July Dashboard Section (Default View for July) -->
                    <section id="july-dashboard-section" class="july-content-section">
                        <!-- July Key Metrics Section -->
                        <section id="july-kpis" class="mb-8 md:mb-12">
                            <h2 class="text-2xl font-semibold text-slate-900 mb-4 text-center">July Monthly Highlights</h2>
                            <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-4 md:gap-6 text-center">
                                <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200">
                                    <p class="text-sm font-medium text-slate-500">Highest Viewership</p>
                                    <p id="julyKpiHighest" class="text-3xl font-bold text-sky-600 mt-1">N/A</p>
                                    <p id="julyKpiHighestDay" class="text-xs text-slate-400"></p>
                                </div>
                                <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200">
                                    <p class="text-sm font-medium text-slate-500">Lowest Viewership</p>
                                    <p id="julyKpiLowest" class="text-3xl font-bold text-amber-600 mt-1">N/A</p>
                                    <p id="julyKpiLowestDay" class="text-xs text-slate-400"></p>
                                </div>
                                <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200">
                                    <p class="text-sm font-medium text-slate-500">Avg. Mid-Week Views</p>
                                    <p id="julyKpiMidWeekAvg" class="text-3xl font-bold text-slate-700 mt-1">N/A</p>
                                    <p class="text-xs text-slate-400">(Tue-Thu)</p>
                                </div>
                                <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200">
                                    <p class="text-sm font-medium text-slate-500">Avg. Weekend Views</p>
                                    <p id="julyKpiWeekendAvg" class="text-3xl font-bold text-slate-700 mt-1">N/A</p>
                                    <p class="text-xs text-slate-400">(Sat-Sun)</p>
                                </div>
                                <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200">
                                    <p class="text-sm font-medium text-slate-500">Total Views (July)</p>
                                    <p id="julyKpiTotalViews" class="text-3xl font-bold text-slate-700 mt-1">N/A</p>
                                    <p class="text-xs text-slate-400">(All Days)</p>
                                </div>
                            </div>
                        </section>

                        <!-- July Daily Viewership by Week Section -->
                        <section id="julyWeeklyDailyViewsSection" class="bg-white p-4 sm:p-6 rounded-xl shadow-sm border border-slate-200 mb-8 md:mb-12">
                            <div class="text-center mb-6">
                                <h2 class="text-2xl font-semibold text-slate-900">July Daily Viewership by Week</h2>
                                <p class="text-slate-600 mt-1">Click a week to see daily view trends for that period.</p>
                                <div class="mt-4 inline-flex bg-slate-100 p-1 rounded-lg text-sm flex-wrap justify-center gap-2">
                                    <button id="julyWeek1DailyBtn" class="px-4 py-1.5 rounded-md text-slate-600 font-medium july-weekly-daily-btn">Week 1</button>
                                    <button id="julyWeek2DailyBtn" class="px-4 py-1.5 rounded-md text-slate-600 font-medium july-weekly-daily-btn">Week 2</button>
                                    <button id="julyWeek3DailyBtn" class="px-4 py-1.5 rounded-md text-slate-600 font-medium july-weekly-daily-btn">Week 3</button>
                                    <button id="julyWeek4DailyBtn" class="px-4 py-1.5 rounded-md text-slate-600 font-medium july-weekly-daily-btn">Week 4</button>
                                </div>
                            </div>
                            <div id="julyDailyChartContainer" class="chart-container hidden">
                                <canvas id="julyDailyViewsChart"></canvas>
                            </div>
                        </section>

                        <!-- July Overall Interactive Chart Section -->
                        <section id="july-charts" class="bg-white p-4 sm:p-6 rounded-xl shadow-sm border border-slate-200 mb-8 md:mb-12">
                            <div class="text-center mb-6">
                                <h2 class="text-2xl font-semibold text-slate-900">July Overall Weekly Performance Analysis</h2>
                                <p class="text-slate-600 mt-1">Compare average performance and volatility across the entire month.</p>
                                <div class="mt-4 inline-flex bg-slate-100 p-1 rounded-lg text-sm">
                                    <button id="julyAvgBtn" class="px-4 py-1.5 rounded-md bg-white text-sky-600 shadow-sm font-semibold july-chart-type-btn">Average Performance</button>
                                    <button id="julyRangeBtn" class="px-4 py-1.5 rounded-md text-slate-600 font-medium july-chart-type-btn">Volatility Analysis</button>
                                </div>
                            </div>

                            <div id="julyAvgChartContainer" class="chart-container">
                                <canvas id="julyAverageViewsChart"></canvas>
                            </div>
                            <div id="julyRangeChartContainer" class="chart-container hidden">
                                <canvas id="julyRangeViewsChart"></canvas>
                            </div>
                        </section>

                        <!-- July Strategic Recommendations Section (Removed) -->
                    </main>
                </section>

            <!-- July Top Titles Section (Initially Hidden) -->
            <section id="july-top-titles-section" class="july-content-section hidden">
                <div class="bg-white p-4 sm:p-6 rounded-xl shadow-sm border border-slate-200 mb-8 md:mb-12">
                    <h2 class="text-2xl font-semibold text-slate-900 mb-4 text-center">Top 10 Titles Views (July)</h2>
                    <p class="text-slate-600 mb-6 text-center">Here are the top 10 performing titles based on viewership data for July:</p>
                    <div class="overflow-x-auto mb-8">
                        <table class="min-w-full rounded-lg overflow-hidden shadow-sm border border-slate-200">
                            <thead class="bg-slate-100 border-b border-slate-200">
                                <tr>
                                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider">Rank</th>
                                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider">Title Name</th>
                                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider">Total Views</th>
                                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider">Total Likes</th>
                                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider">Avg. Views Per Clip</th>
                                </tr>
                            </thead>
                            <tbody id="julyTopTitlesTableBody" class="divide-y divide-slate-200 text-sm text-slate-700">
                                <!-- Data will be inserted here by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                    <!-- Charts for July Top Titles -->
                    <div class="mt-8">
                        <h3 class="text-xl font-semibold text-slate-900 mb-4 text-center">Total Views by Title</h3>
                        <div class="chart-container mb-8">
                            <canvas id="julyTopTitlesViewsChart"></canvas>
                        </div>

                        <h3 class="text-xl font-semibold text-slate-900 mb-4 text-center">Average Views Per Clip by Title</h3>
                        <div class="chart-container mb-8">
                            <canvas id="julyAvgViewsPerClipChart"></canvas>
                        </div>

                        <h3 class="text-xl font-semibold text-slate-900 mb-4 text-center">Total Likes by Title</h3>
                        <div class="chart-container">
                            <canvas id="julyLikesChart"></canvas>
                        </div>
                    </div>

                    <div class="text-center mt-4">
                        <button id="julyShowAllTitlesBtn" class="px-4 py-2 rounded-md bg-sky-600 text-white shadow-sm font-semibold hover:bg-sky-700 transition-colors duration-200">Show All Titles</button>
                    </div>

                    <div class="mt-8 p-4 bg-slate-50 rounded-lg shadow-sm border border-slate-200">
                        <h3 class="text-lg font-semibold text-slate-800 mb-2">Insights from July Top Titles:</h3>
                        <ul class="list-disc pl-5 space-y-2 text-slate-700">
                            <li>**Dominant Performers:** "Ommi" and "Al Madeena Al Ba'eeda" are clear leaders in total views, indicating strong audience pull. "Ommi" also boasts exceptionally high likes and average views per clip, suggesting highly engaging content.</li>
                            <li>**Engagement vs. Reach:** "Fondooq Al Ahlam" has a high number of likes and average views per clip, showing strong engagement despite lower overall views compared to the top two. This title could be a candidate for increased promotion to expand its reach.</li>
                            <li>**High Potential:** "Leyla" and "FIFA Club World Cup 2025" also show significant total views. "Leyla" has a decent average views per clip, indicating good content quality.</li>
                            <li>**Areas for Improvement:** Titles like "Harb El Gibali" and "To Win Or To Win" have lower total views, likes, and average views per clip, suggesting opportunities to review content strategy or promotional efforts for these titles.</li>
                            <li>**Content Strategy:** The data suggests that content like "Ommi" and "Al Madeena Al Ba'eeda" resonates strongly with the audience. Analyzing their specific themes, formats, and release patterns could provide valuable insights for future content creation.</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- July Recommendation Titles Section (Removed from HTML) -->

            <!-- Third Party Views Overview Section (New) -->
            <section id="third-party-overview-section" class="report-content-section hidden">
                <div class="bg-white p-8 rounded-xl shadow-lg border border-slate-200 text-center max-w-2xl mx-auto w-full">
                    <h1 class="text-3xl font-bold text-slate-900 mb-4">Third Party Views Overview</h1>
                    <p class="text-lg text-slate-600 mb-6">Select a month to view detailed third-party viewership data.</p>
                    
                    <div class="flex flex-col sm:flex-row justify-center gap-4 mb-8">
                        <button class="inline-block px-8 py-3 bg-sky-600 text-white rounded-md shadow-md hover:bg-sky-700 transition-colors duration-200 third-party-month-btn" data-target-section="third-party-june-content">June Third Party</button>
                        <button class="inline-block px-8 py-3 bg-slate-200 text-slate-800 rounded-md shadow-md hover:bg-slate-300 transition-colors duration-200 third-party-month-btn" data-target-section="third-party-july-content">July Third Party</button>
                    </div>
                    <p class="text-slate-500 text-sm">More detailed third-party data and charts would appear here upon selection.</p>
                </div>
            </section>

            <!-- Third Party Views - June (Placeholder) -->
            <section id="third-party-june-content" class="report-content-section hidden">
                <div class="bg-white p-4 sm:p-6 rounded-xl shadow-sm border border-slate-200 mb-8 md:mb-12 text-center">
                    <h2 class="text-2xl font-semibold text-slate-900 mb-4">Third Party Views - June</h2>
                    <p class="text-slate-600">Detailed third-party data for June will be available here.</p>
                    <button class="mt-4 px-4 py-2 bg-slate-200 text-slate-800 rounded-md shadow-sm hover:bg-slate-300 back-to-main-dashboard">Back to Overview</button>
                </div>
            </section>

            <!-- Third Party Views - July (Detailed Content) -->
            <section id="third-party-july-content" class="report-content-section hidden">
                <header class="clip-performance-header">
                    <h1 class="text-4xl md:text-5xl font-bold">Third Party Views - July 2025</h1>
                    <p class="mt-4 text-lg md:text-xl text-gray-200">Deep Dive into Clip Views & Engagement</p>
                </header>

                <main class="max-w-7xl mx-auto p-4 sm:p-6 md:p-8">
                    <!-- Overall KPIs -->
                    <section class="mb-8 md:mb-12">
                        <h2 class="clip-performance-section-title">Overall Performance Metrics</h2>
                        <div class="grid grid-cols-1 sm:grid-cols-3 gap-6">
                            <div class="kpi-card total-profiles">
                                <p id="total-profiles">40</p>
                                <p>Total Profiles</p>
                            </div>
                            <div class="kpi-card total-clips">
                                <p id="total-clips">544</p>
                                <p>Total Clips</p>
                            </div>
                            <div class="kpi-card total-views">
                                <p id="total-views">1.38M+</p>
                                <p>Total Views</p>
                            </div>
                        </div>
                    </section>

                    <!-- Charts Section -->
                    <section class="mb-8 md:mb-12">
                        <h2 class="clip-performance-section-title">Viewership Trends</h2>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200 chart-container">
                                <canvas id="totalViewsChart"></canvas>
                            </div>
                            <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200 chart-container">
                                <canvas id="avgViewsChart"></canvas>
                            </div>
                        </div>
                    </section>

                    <!-- Top Total Views Chart & Table Section -->
                    <section class="mb-8 md:mb-12">
                        <h2 class="clip-performance-section-title">Top 10 Profiles by Total Views</h2>
                        <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200">
                            <!-- Chart for Top 10 Profiles by Total Views -->
                            <div class="chart-container mb-4">
                                <canvas id="topTotalViewsChart"></canvas>
                            </div>
                            <div class="text-center mt-4">
                                <button id="showTopTotalViewsTableBtn" class="px-4 py-2 rounded-md bg-sky-600 text-white shadow-sm font-semibold hover:bg-sky-700 transition-colors duration-200">More Details</button>
                            </div>
                            <div id="topTotalViewsTableContainer" class="overflow-x-auto mt-6 hidden">
                                <table class="min-w-full rounded-lg overflow-hidden shadow-sm border border-slate-200">
                                    <thead class="bg-slate-100 border-b border-slate-200">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider">Profile Name</th>
                                            <th class="px-4 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider">Total Clips</th>
                                            <th class="px-4 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider">Total Views</th>
                                            <th class="px-4 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider">Avg. Views/Clip</th>
                                        </tr>
                                    </thead>
                                    <tbody id="topTotalViewsTableBody" class="divide-y divide-slate-200 text-sm text-slate-700">
                                        <!-- Data will be inserted here by JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </section>

                    <!-- Low Performing Titles Section -->
                    <section class="mb-8 md:mb-12">
                        <h2 class="clip-performance-section-title">Low 5 Profiles by Average Views per Clip</h2>
                        <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200">
                            <div class="chart-container mb-4">
                                <canvas id="lowAvgViewsChart"></canvas>
                            </div>
                            <div class="text-center mt-4">
                                <button id="showLowAvgViewsTableBtn" class="px-4 py-2 rounded-md bg-sky-600 text-white shadow-sm font-semibold hover:bg-sky-700 transition-colors duration-200">More Details</button>
                            </div>
                            <div id="lowTitlesTableContainer" class="overflow-x-auto mt-6 hidden">
                                <table class="min-w-full rounded-lg overflow-hidden shadow-sm border border-slate-200">
                                    <thead class="bg-slate-100 border-b border-slate-200">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider">Profile Name</th>
                                            <th class="px-4 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider">Total Clips</th>
                                            <th class="px-4 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider">Total Views</th>
                                            <th class="px-4 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider">Avg. Views/Clip</th>
                                        </tr>
                                    </thead>
                                    <tbody id="lowTitlesTableBody" class="divide-y divide-slate-200 text-sm text-slate-700">
                                        <!-- Data will be inserted here by JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </section>


                    <!-- Strategic Recommendations for Third Party Views -->
                    <section class="mb-8 md:mb-12">
                        <h2 class="clip-performance-section-title">Strategic Recommendations for Third Party Views</h2>
                        <div class="space-y-4 max-w-4xl mx-auto">
                            <div class="recommendation-card blue-border">
                                <h3>Focus on High-Performing Profiles</h3>
                                <p>Double down on content strategies that are working for top profiles like "Leyla" and "Al Madeena Al Ba'eeda". Analyze their content themes, posting schedules, and engagement tactics to replicate success across other profiles.</p>
                            </div>
                            <div class="recommendation-card yellow-border">
                                <h3>Improve Low-Performing Content</h3>
                                <p>For profiles with low average views per clip (e.g., "Tash: Al Awda Season 19", "El Kebeer Awi_TV"), conduct a deeper content audit. Consider re-editing existing clips, experimenting with new formats, or pausing content that consistently underperforms.</p>
                            </div>
                            <div class="recommendation-card red-border">
                                <h3>Leverage Viral Potential</h3>
                                <p>Identify specific clips that have gone viral or significantly outperformed their profile's average. Study the characteristics of these clips (e.g., emotional impact, trending topics, unique editing) and apply these learnings to future content creation.</p>
                            </div>
                        </div>
                    </section>

                    <div class="text-center mt-8">
                        <button class="px-6 py-3 bg-sky-600 text-white rounded-md shadow-md hover:bg-sky-700 transition-colors duration-200 back-to-main-dashboard">Back to Overview</button>
                    </div>
                </main>

                <footer class="clip-performance-footer">
                    <p>&copy; 2025 Viewership Insights. All rights reserved.</p>
                    <p>Data as of July 8, 2025</p>
                </footer>
            </section>

            <!-- Additional Insights Section -->
            <section id="additional-insights-content" class="report-content-section hidden">
                <header class="text-center mb-8 md:mb-12">
                    <h1 class="text-3xl md:text-4xl font-bold text-slate-900">Additional Viewership Insights</h1>
                    <p class="mt-2 text-lg text-slate-600">Deeper Dives into Performance Metrics</p>
                </header>

                <main class="max-w-7xl mx-auto p-4 sm:p-6 md:p-8">
                    <!-- Week-on-Week Performance Comparison (June vs. July) -->
                    <section id="week-comparison-section" class="bg-white p-4 sm:p-6 rounded-xl shadow-sm border border-slate-200 mb-8 md:mb-12">
                        <h2 class="text-2xl font-semibold text-slate-900 mb-4 text-center">Week-on-Week Performance Comparison (June vs. July)</h2>
                        <p class="text-slate-600 mb-6 text-center">Comparing daily viewership and total views for the first two weeks of June and July.</p>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                            <div class="bg-slate-50 p-4 rounded-lg shadow-sm border border-slate-200">
                                <h3 class="text-lg font-semibold text-slate-800 mb-2">June Week 1 (Jun 1 - Jun 7)</h3>
                                <p class="text-xl font-bold text-sky-700"><span id="juneWeek1TotalViews"></span> Views</p>
                            </div>
                            <div class="bg-slate-50 p-4 rounded-lg shadow-sm border border-slate-200">
                                <h3 class="text-lg font-semibold text-slate-800 mb-2">June Week 2 (Jun 8 - Jun 14)</h3>
                                <p class="text-xl font-bold text-sky-700"><span id="juneWeek2TotalViews"></span> Views</p>
                            </div>
                            <div class="bg-slate-50 p-4 rounded-lg shadow-sm border border-slate-200">
                                <h3 class="text-lg font-semibold text-slate-800 mb-2">July Week 1 (Jun 30 - Jul 6)</h3>
                                <p class="text-xl font-bold text-emerald-700"><span id="julyWeek1TotalViews"></span> Views</p>
                            </div>
                            <div class="bg-slate-50 p-4 rounded-lg shadow-sm border border-slate-200">
                                <h3 class="text-lg font-semibold text-slate-800 mb-2">July Week 2 (Jul 7 - Jul 13)</h3>
                                <p class="text-xl font-bold text-emerald-700"><span id="julyWeek2TotalViews"></span> Views</p>
                            </div>
                        </div>

                        <div class="chart-container">
                            <canvas id="weekComparisonChart"></canvas>
                        </div>

                        <div class="mt-8 p-4 bg-slate-50 rounded-lg shadow-sm border border-slate-200">
                            <h3 class="text-lg font-semibold text-slate-800 mb-2">Analysis of Trends:</h3>
                            <p class="text-slate-700 leading-relaxed">
                                The comparison between the first two weeks of June and July reveals interesting shifts in viewership patterns.
                                June's first two weeks show a relatively stable daily viewership, with a slight dip on weekends and a recovery during weekdays.
                                In contrast, July's first week (starting June 30th) shows a notable peak on Friday, July 4th, indicating a strong one-off event or content release. This peak significantly boosts the total views for July Week 1 compared to June's corresponding period.
                                July Week 2 exhibits more fluctuation, with a higher Sunday peak (July 13th) compared to June's weekends, suggesting a potential change in audience behavior or content strategy on weekends in July.
                                Overall, July's initial weeks appear to have higher peak views, particularly on specific days, while June showed more consistent mid-range performance. This could be due to new content launches, seasonal viewing habits, or targeted promotional efforts in July.
                            </p>
                        </div>
                    </section>
                </main>
            </section>

        </div> <!-- End of june-report-content container -->

        <footer class="text-center mt-12 text-slate-500 text-sm">
            <p>Report Generated: July 8, 2025</p>
        </footer>
    </div>

    <!-- Modal Structure -->
    <div id="shortsModal" class="modal-overlay">
        <div class="modal-content">
            <button class="modal-close-btn" id="closeModalBtn">&times;</button>
            <h3 class="text-xl font-bold text-slate-800 mb-4" id="modalTitle">Leyla Shorts Views</h3>
            <div class="modal-table-container">
                <table class="modal-table">
                    <thead>
                        <tr>
                            <th>Short Title</th>
                            <th>Views</th>
                        </tr>
                    </thead>
                    <tbody id="modalTableBody">
                        <!-- Shorts data will be inserted here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Debug Message Element -->
    <div id="debugMessage" class="hidden"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const fullDailyData = [
                { date: 'Jun 1', day: 'Sunday', views: 433 },
                { date: 'Jun 2', day: 'Monday', views: 596 },
                { date: 'Jun 3', day: 'Tuesday', views: 641 },
                { date: 'Jun 4', day: 'Wednesday', views: 655 },
                { date: 'Jun 5', day: 'Thursday', views: 825 },
                { date: 'Jun 6', day: 'Friday', views: 553 },
                { date: 'Jun 7', day: 'Saturday', views: 542 },
                // Week 2
                { date: 'Jun 8', day: 'Sunday', views: 639 },
                { date: 'Jun 9', day: 'Monday', views: 725 },
                { date: 'Jun 10', day: 'Tuesday', views: 823 },
                { date: 'Jun 11', day: 'Wednesday', views: 811 },
                { date: 'Jun 12', day: 'Thursday', views: 752 },
                { date: 'Jun 13', day: 'Friday', views: 738 },
                { date: 'Jun 14', day: 'Saturday', views: 685 },
                // Week 3
                { date: 'Jun 15', day: 'Sunday', views: 788 },
                { date: 'Jun 16', day: 'Monday', views: 825 },
                { date: 'Jun 17', day: 'Tuesday', views: 795 },
                { date: 'Jun 18', day: 'Wednesday', views: 752 },
                { date: 'Jun 19', day: 'Thursday', views: 731 },
                { date: 'Jun 20', day: 'Friday', views: 726 },
                { date: 'Jun 21', day: 'Saturday', views: 759 },
                // Week 4
                { date: 'Jun 22', day: 'Sunday', views: 743 },
                { date: 'Jun 23', day: 'Monday', views: 752 },
                { date: 'Jun 24', day: 'Tuesday', views: 794 },
                { date: 'Jun 25', day: 'Wednesday', views: 839 },
                { date: 'Jun 26', day: 'Thursday', views: 834 },
                { date: 'Jun 27', day: 'Friday', views: 859 },
                { date: 'Jun 28', day: 'Saturday', views: 681 },
                // Week 5 (partial, not explicitly a 'Week 5' tab, but included in 'All Weeks')
                { date: 'Jun 29', day: 'Sunday', views: 692 },
                { date: 'Jun 30', day: 'Monday', views: 717 }
            ];

            const top10TitlesData = [
                { rank: 1, title: "AL Madeena Al Ba'eeda", views: "5.93M", likes: "15095", avgViewsPerClip: "28353" },
                { rank: 2, title: "Ommi", views: "2.85M", likes: "10211", avgViewsPerClip: "13527" },
                { rank: 3, title: "FIFA Club World Cup 2025", views: "1.9M", likes: "5586", avgViewsPerClip: "8885" },
                { rank: 4, title: "Fondooq Al Ahlam", views: "1.54M", likes: "4731", avgViewsPerClip: "29657" },
                { rank: 5, title: "Leyla", views: "0.93M", likes: "2265", avgViewsPerClip: "11876" },
                { rank: 6, title: "Aser", views: "0.67M", likes: "1906", avgViewsPerClip: "4258" },
                { rank: 7, title: "Fareed Season 3", views: "0.41M", likes: "825", avgViewsPerClip: "5392" },
                { rank: 8, title: "Laylet El Eid", views: "0.28M", likes: "465", avgViewsPerClip: "16519" },
                { rank: 9, title: "Harb El Gibali", views: "0.25M", likes: "594", avgViewsPerClip: "3400" },
                { rank: 10, title: "Ghayeb Fi Bilad Al Ajayeb", views: "0.24M", likes: "414", avgViewsPerClip: "2837" }
            ];

            // Data for Leyla shorts (extracted from image_25dc93.png)
            const leylaShortsData = [
                { title: "خطة ليلي", views: 84579 },
                { title: "الشغل لسا ما انتهى", views: 57890 },
                { title: "ليلى وكلام قوي جداً", views: 19239 },
                { title: "أنا بعرف منيح شو بدها", views: 17080 },
                { title: "الم الماضي و الحاضر", views: 15537 },
                { title: "خطة نور المحكمة", views: 14582 },
                { title: "مشهد رومانسي ❤️", views: 13623 },
                { title: "عشاء تعارف لخطبة مالي", views: 13380 },
                { title: "تصعيد قوي جداً", views: 13206 },
                { title: "الذكريات الحلوة", views: 12049 },
                { title: "حادث بالمزبلة", views: 11825 },
                { title: "نور بتحكم في مالي و تتذكر ابنها", views: 11418 },
                { title: "نور تحاول التقرب من جينو", views: 10530 },
                { title: "لازم نحل القصة ❌", views: 10270 },
                { title: "القدر يجمعهم", views: 9832 },
                { title: "نور بدها تاخد ابنها", views: 9383 },
                { title: "الام ما بتعود", views: 4117 },
                { title: "قصة الكازوز", views: 3803 },
                { title: "موقف محرج جداً", views: 2834 },
                { title: "نور وقعت بمشكلة ما رح تقدر تخرج منها بسهولة!", views: 419 }
            ];

            // Shorts data extracted from image_239e3f.png, image_23221c.png, image_230f94.png, image_230f3b.png, image_230ec1.png, image_1921b7.png, image_192196.png, image_192177.png, image_19213f.png, image_191e95.png
            const shortsDataFromImage = {
                "Al Atawla": [
                    { title: "خطة ليلي", views: 149 },
                    { title: "الشغل لسا ما انتهى", views: 57 },
                    { title: "ليلى وكلام قوي جداً", views: 339 },
                    { title: "أنا بعرف منيح شو بدها", views: 100 },
                    { title: "الم الماضي و الحاضر", views: 342 },
                    { title: "خطة نور المحكمة", views: 150 },
                    { title: "مشهد رومانسي ❤️", views: 108 },
                    { title: "عشاء تعارف لخطبة مالي", views: 149 },
                    { title: "تصعيد قوي جداً", views: 108 },
                    { title: "الذكريات الحلوة", views: 101 },
                    { title: "حادث بالمزبلة", views: 100 }
                ],
                "Fareed S3": [
                    { title: "بده الشك و الامور تتكشف 💥", views: 5074 },
                    { title: "سيبنان ينفجر من الغضب", views: 3205 },
                    { title: "سيبنان ما راح يهدئ", views: 4019 },
                    { title: "مواجهة سيبنان و سيران ❤️", views: 6582 },
                    { title: "اول ليلة لسيبنان و سيران ❤️", views: 14468 },
                    { title: "سيبنان بده يبعد مع سيران 💔", views: 7119 },
                    { title: "فريد بيتذكر الماضي �", views: 7529 },
                    { title: "الضغط كبير عليها 😥 #شاهد #دراما #فريد", views: 5307 },
                    { title: "فرحة المولود الجديد 👶", views: 4469 },
                    { title: "فريد كسر قلبها 💔", views: 3883 },
                    { title: "فريد يقدم لازواج 👰🤵", views: 2002 },
                    { title: "صدفة غريبة 🤯", views: 2325 },
                    { title: "اتقدم لها في الاخير 🤩", views: 2400 },
                    { title: "في شي بين سيبنان و فريد !", views: 2697 },
                    { title: "فريد و العيلة", views: 3361 },
                    { title: "احداث خطيرة", views: 3623 },
                    { title: "فريد قرر الزواج 💍", views: 17522 }
                ],
                "Al Ameel (Icerde)": [
                    { title: "الخطة المكشوفة", views: 1079 },
                    { title: "امير بدل خليل وفريقه على مكان الشحنة الحقيقية 🤯", views: 37140 },
                    { title: "وسام بيعابيها صح", views: 1225 },
                    { title: "مشاعر الحب 🔥", views: 1790 },
                    { title: "القتل عدداً 😱", views: 1615 },
                    { title: "المعلم هو اللي بيعتني 😔", views: 30465 },
                    { title: "عشاء رومانسي", views: 2219 },
                    { title: "محتار من وين ابلش", views: 1840 },
                    { title: "طمني مين صاحب الاغراض", views: 1290 },
                    { title: "تهديد من الطرفين", views: 1560 },
                    { title: "الشرف أهم شي", views: 1132 },
                    { title: "هل خوله بنت شارع ؟", views: 1520 },
                    { title: "سيادة النقيب وسام", views: 1079 }
                ],
                "Kolna Eyal Qarya": [
                    { title: "اول لما شاف الكبدة قام", views: 60 },
                    { title: "الكل يتفرج عند بيت سليم 🤣", views: 2019 },
                    { title: "ابو سعد قطع عليهم المشاهدة", views: 2261 },
                    { title: "البصل و البورصة 🤑", views: 13144 },
                    { title: "خطة محكمة 🧐", views: 1046 },
                    { title: "رجوع الخاله 😥", views: 829 },
                    { title: "ضحكة صافية ما تشبه غيرها 🤍👨‍👩‍👧‍👦", views: 21304 },
                    { title: "قطعة الارض صارت في جيبيهم 🤩", views: 2903 },
                    { title: "كريم يدفع العربون", views: 830 },
                    { title: "سليم يسلم الاوراق", views: 3406 },
                    { title: "سليم بعد ما خسروا 20 الف 🤬", views: 1370 },
                    { title: "ابو ضاري يطرد سليم من مكتبه", views: 319 },
                    { title: "سليم يكدب 💔", views: 741 },
                    { title: "الام و اصدقائه 🤣", views: 1759 },
                    { title: "29,000 ريال ", views: 20 },
                    { title: "البحث عن وظيفة 🤔", views: 15036 }
                ],
                "Min Share’ Al Haram Ela... Season 1": [
                    { title: "انس و الدنانير", views: 13485 },
                    { title: "وجع من القلب", views: 11308 },
                    { title: "هل هذا تهديد ؟", views: 6099 },
                    { title: "ماذا صنع الخوف", views: 4478 },
                    { title: "نفسي في حاجه زفرة", views: 3339 },
                    { title: "الاتهام بالسرقة", views: 2222 },
                    { title: "كريمة تعبت اوي", views: 1856 },
                    { title: "موقف محرج جداً", views: 1232 },
                    { title: "الراقصة", views: 1133 },
                    { title: "مشهد كوميدي", views: 639 },
                    { title: "وين هالبنات؟", views: 427 },
                    { title: "بلاش المشوار داه !", views: 416 },
                    { title: "الخيانة", views: 409 },
                    { title: "ايش صار ؟", views: 381 },
                    { title: "وين تقفي? ", views: 326 }
                ],
                "Big Time Podcast": [
                    { title: "ملكة الاحساس", views: 395 },
                    { title: "اليسا ورسالة الفن", views: 76 },
                    { title: "ايلي صعب مع عمرو اديب", views: 209 },
                    { title: "امتي ننبسط و نرتاح", views: 175 },
                    { title: "الطموح لا ينتهي", views: 369 },
                    { title: "حماقي مش بيحب المفاجأت", views: 1560 },
                    { title: "ايه حكاية الفيديو اي اي", views: 1567 },
                    { title: "حماقي ونداء للحفاظ على الجبيل", views: 159 },
                    { title: "الجمهور دلوقتي بقي مختلف", views: 1736 },
                    { title: "الشك في الحوايك", views: 514 },
                    { title: "مشاكل الفنانين 😥", views: 103 },
                    { title: "عمرو مش اعلامي عادي", views: 28291 },
                    { title: "الاستعراض على المسرح صعب", views: 9017 },
                    { title: "المسرح زمان", views: 371 },
                    { title: "اختيار دنيا للادوار 🪶", views: 145 },
                    { title: "عمرو اديب مش سهل يضحك", views: 109 }
                ],
                "Shatti Ya Beirut": [
                    { title: "مشهد رومانسي ❤️", views: 30465 },
                    { title: "الاتفاق شم القتل", views: 6114 },
                    { title: "اللعبة قربت تخلص!", views: 1568 },
                    { title: "اماني بتفتح الباب و بتهرب", views: 487 },
                    { title: "صوته عالي وعيونه مليانة غضب", views: 409 },
                    { title: "يم وعبدالقادر: لحظة الحقيقة", views: 373 },
                    { title: "مشهد مؤثر", views: 288 },
                    { title: "كنت سهرانة عند رشاد", views: 261 },
                    { title: "رسالة تهديد نهز الكيان!", views: 241 },
                    { title: "الشرطة بتكفيل توفيق والناس عم تتفرج", views: 240 },
                    { title: "ذنب الماضي بيطارد عبدال", views: 227 },
                    { title: "عبدالله والتسليم", views: 197 },
                    { title: "أصعب لحظة على أي أم!", views: 191 },
                    { title: "ابوها في المستشفى", views: 185 },
                    { title: "خبر حلو صادم ❌", views: 156 },
                    { title: "تبادل الأسرى !", views: 128 },
                    { title: "عشاء المخطوف", views: 116 },
                    { title: "مشهد كوميدي", views: 83 },
                    { title: "نايمة في المستشفى", views: 78 },
                    { title: "عبد القادر ماقدر يحميها", views: 73 },
                    { title: "مشهد مؤثر", views: 77 }
                ],
                "Lil Mawt": [
                    { title: "تصعيد خطير", views: 11937 },
                    { title: "مواجهة صعبة ❌", views: 8543 },
                    { title: "طلب عمر من فيفي الهرب", views: 3609 },
                    { title: "هادي بيفكر بمستقبله", views: 3216 },
                    { title: "لحظة المواجهة بين فواز وهادي", views: 2982 },
                    { title: "غموض", views: 1754 },
                    { title: "سحر تحاول حل الامور", views: 1406 },
                    { title: "فكرت وفررت", views: 1344 },
                    { title: "اعتراف محمود بالتهمة", views: 999 },
                    { title: "خير الزواج", views: 980 },
                    { title: "حنان راح تتجوز", views: 871 },
                    { title: "سحر و ريم بيعرفوا بعض", views: 841 },
                    { title: "الالي و الموت", views: 771 },
                    { title: "مافي مبروك؟", views: 593 },
                    { title: "موقف محرج", views: 507 },
                    { title: "أمها بعدها عايشة!", views: 291 },
                    { title: "ما كان يتوقعها ترده كدا", views: 215 },
                    { title: "صدمة الزواج", views: 77 },
                    { title: "الخيانة", views: 23 }
                ],
                "Al Qadar": [
                    { title: "ايش عم يخيبي ايهاب ؟ 🤔", views: 258 },
                    { title: "نور و زيد", views: 1145 },
                    { title: "عدم الالتزام بالخطة 😌", views: 614 },
                    { title: "يوسف الخاطف 🤯", views: 3498 },
                    { title: "اللحظة الحاسمة", views: 4287 },
                    { title: "الخلاص اتأخر", views: 806 },
                    { title: "تالا تواجه نجوى 💔", views: 7446 },
                    { title: "عرفتي شي؟ 🤨", views: 2935 },
                    { title: "الصفقة 🧘‍♀️", views: 1235 },
                    { title: "مشهد قوي جدا 😭", views: 2130 },
                    { title: "صدمة وجود ابوه 😡", views: 6180 },
                    { title: "زيد بيساعد نور و اختها 🤍", views: 1886 },
                    { title: "امير و نور 🤍", views: 3498 },
                    { title: "تالا و طارق", views: 429 }
                ],
                "Al -Meerath": [
                    { title: "تهديد رسمي 😡", views: 274 },
                    { title: "الفرحة المنتظرة 🤩", views: 851 },
                    { title: "فارس واحدات خطيرة 😱", views: 526 },
                    { title: "خطة شيطانية", views: 950 },
                    { title: "عملية الخطف 😱", views: 96 },
                    { title: "آخر مهمة", views: 1407 },
                    { title: "مثل انك حرفة الشقة ❤️", views: 1378 },
                    { title: "اطلبوا الاسعاف", views: 80 },
                    { title: "هيفاء ماتت قدام عينيي 😭", views: 80 },
                    { title: "الشهود مطلوبين", views: 87 },
                    { title: "شهد مصدومة 😨", views: 62 },
                    { title: "ابو مصعب يهرب 💔", views: 97 },
                    { title: "عمر فارس ويوسف 👨‍👦", views: 135 },
                    { title: "النصيحة واجب", views: 112 },
                    { title: "شهد و الجنون ❌", views: 14 },
                    { title: "تصرفات مجنونة 🤪", views: 391 },
                    { title: "منهم بالقتل ❌", views: 256 },
                    { title: "الشك ❗️", views: 426 },
                    { title: "المواجهة 💥", views: 34978 },
                    { title: "الجريمة", views: 33864 },
                    { title: "عيني في عينك 👀", views: 33642 }
                ],
                "Tash: Al Awda Season 19": [
                    { title: "أبي فلوسي اليوم", views: 97 },
                    { title: "تحليل الكرة الاستراتيجي", views: 76 },
                    { title: "طارق والتحقيق", views: 63 },
                    { title: "كيف انت زوجها", views: 51 },
                    { title: "طارق", views: 48 },
                    { title: "اجتماع العائلة", views: 44 },
                    { title: "الكلام محسوم ❌", views: 40 },
                    { title: "موقف محرج", views: 8 },
                    { title: "صنع محتوى وبيعه لبعض الاشخاص المؤثرين على مواقع التواصل الاجتماعي", views: 4 },
                    { title: "فلاور في ورطة", views: 2 }
                ],
                "El Kebeer Awi_TV": [
                    { title: "ظهور حزلقوم في برنامج رياضي 🤣", views: 41 },
                    { title: "حزلقوم قلب الاستوديو😂", views: 195 },
                    { title: "حزلقوم عمل مصيبة 😱", views: "Missing" },
                    { title: "الدكتور ربيع طماع", views: 93 },
                    { title: "فريق المزاريطة لكرة القدم⚽", views: 46 },
                    { title: "حزلقوم و الفريق !", views: 53 },
                    { title: "خطة محكمة", views: 54 },
                    { title: "من الجول للجول 🤣", views: 47 },
                    { title: "انسحاب حزلقوم 😱", views: 43 },
                    { title: "الكبير معندوش ثقة في الفريق ❤️", views: 43 },
                    { title: "دعم الفريق", views: "Missing" },
                    { title: "بعزق بيصمد كل الكور 😱", views: "Missing" },
                    { title: "الدوار في خطر", views: "Missing" },
                    { title: "الامثال المصرية 😂", views: 33 },
                    { title: "الكبير و حفني 😂", views: 38 },
                    { title: "حفني هيبقي جوزي", views: 31 }
                ],
                "Bait & So'al 2025": [ // Updated name
                    { title: "موقف طريف ضحكنا كلنا!", views: "Missing" },
                    { title: "مشاركة الجمهور", views: 358 },
                    { title: "ايش فهمت من هذا البيت", views: 26 }
                ],
                "Bab Al Hara": [
                    { title: "الشرطة بتدور على شخص مهم 😱", views: 110 },
                    { title: "مختار بيستجوب حمدي", views: 254 },
                    { title: "بينتظروا الولاد", views: 475 },
                    { title: "الاحتلال ❌", views: 428 },
                    { title: "الأحلام", views: 740 },
                    { title: "الزواج", views: 97 },
                    { title: "تفريق الأخو 😥", views: 96 },
                    { title: "ابو حاتم", views: 483 },
                    { title: "الزوجة الجديدة 🤣", views: 483 }
                ],
                "Wlad Badee'a Season 1": [
                    { title: "مختار و السجن", views: 4017 },
                    { title: "القاتل", views: 686 },
                    { title: "وردة", views: 383 },
                    { title: "شاهي يطلب التقرب", views: 349 },
                    { title: "الخيانة", views: 345 },
                    { title: "تهديد !", views: 241 },
                    { title: "بدي مساعدتك أبو الهول!", views: 239 },
                    { title: "انت مطلوب من الدولة", views: 232 },
                    { title: "أبو الهول وخطة محكمة", views: 206 },
                    { title: "الخدعة الكبرى", views: 189 },
                    { title: "اكتشاف الانتحار", views: 153 },
                    { title: "شاهين انفجر من الصدمة!", views: 123 },
                    { title: "جنون العظمة", views: 98 },
                    { title: "تفسير المرض النفسي", views: 94 },
                    { title: "شاهي", views: 87 },
                    { title: "شاهين يضرب مختار عشان الفيديو", views: 62 },
                    { title: "شاهين اضرب بالنار", views: 53 },
                    { title: "سرقة مدينة شاهين", views: 33 },
                    { title: "يحرق شاهين وياسين مدينة أبو هديل", views: 21 },
                    { title: "شاهين بيصور فيديو", views: 18 },
                    { title: "العارف بيصور أبو هديل في موقف محرج", views: 18 }
                ],
                "Zawja Waheda La Takfi Season 1": [{ title: "Clip 1", views: "Available Soon!" }, { title: "Clip 2", views: "Available Soon!" }]
            };


            // Combine Leyla's data with the specific data from the image and generic placeholders for others
            const allTitlesShortsData = {
                "Leyla": leylaShortsData,
                "AL Kha'en": [{ title: "Clip 1", views: "Available Soon!" }, { title: "Clip 2", views: "Available Soon!" }],
                "Ahla Ma Tash": [{ title: "Clip 1", views: "Available Soon!" }, { title: "Clip 2", views: "Available Soon!" }],
                "Al -Meerath": shortsDataFromImage["Al -Meerath"],
                "Al Ameel (Icerde)": shortsDataFromImage["Al Ameel (Icerde)"],
                "Al Atawla": shortsDataFromImage["Al Atawla"],
                "Al Hayba": [{ title: "Clip 1", views: "Available Soon!" }, { title: "Clip 2", views: "Available Soon!" }],
                "Al Khotta Baa": [{ title: "Clip 1", views: "Available Soon!" }, { title: "Clip 2", views: "Available Soon!" }],
                "Al Le'ba: Level Al Wahsh": [{ title: "Clip 1", views: "Available Soon!" }, { title: "Clip 2", views: "Available Soon!" }],
                "Al Qadar": shortsDataFromImage["Al Qadar"],
                "Amr Ikhlaa S3": [{ title: "Clip 1", views: "Available Soon!" }, { title: "Clip 2", views: "Available Soon!" }],
                "Awdat Khalati": [{ title: "Clip 1", views: "Available Soon!" }, { title: "Clip 2", views: "Available Soon!" }],
                "Bab Al Hara": shortsDataFromImage["Bab Al Hara"], // Updated
                "Bait & So'al 2025": shortsDataFromImage["Bait & So'al 2025"], // Updated name and data
                "Banat Al Thanawi": [{ title: "Clip 1", views: "Available Soon!" }, { title: "Clip 2", views: "Available Soon!" }],
                "Beyt Al Ankaboot": [{ title: "Clip 1", views: "Available Soon!" }, { title: "Clip 2", views: "Available Soon!" }],
                "Big Time Podcast": shortsDataFromImage["Big Time Podcast"],
                "El Hashashin": [{ title: "Clip 1", views: "Available Soon!" }, { title: "Clip 2", views: "Available Soon!" }],
                "El Kebeer Awi_TV": shortsDataFromImage["El Kebeer Awi_TV"], // Updated
                "Fareed S3": shortsDataFromImage["Fareed S3"],
                "Gaafar El Omda": [{ title: "Clip 1", views: "Available Soon!" }, { title: "Clip 2", views: "Available Soon!" }],
                "Gamgoum Wa Bimbim: Al Sharika Al Almaniya Li Mokafahat Al Khawareq": [{ title: "Clip 1", views: "Available Soon!" }, { title: "Clip 2", views: "Available Soon!" }],
                "Horouj": [{ title: "Clip 1", views: "Available Soon!" }, { title: "Clip 2", views: "Available Soon!" }],
                "Kermal Al Walad": [{ title: "Clip 1", views: "Available Soon!" }, { title: "Clip 2", views: "Available Soon!" }],
                "Kolna Eyal Qarya": shortsDataFromImage["Kolna Eyal Qarya"],
                "Lil Mawt": shortsDataFromImage["Lil Mawt"],
                "Mama Ghaneema Season 1": [{ title: "Clip 1", views: "Available Soon!" }, { title: "Clip 2", views: "Available Soon!" }],
                "Melh Wa Samra Season 1": [{ title: "Clip 1", views: "Available Soon!" }, { title: "Clip 2", views: "Available Soon!" }],
                "Min Share’ Al Haram Ela... Season 1": shortsDataFromImage["Min Share’ Al Haram Ela... Season 1"],
                "Moftaraq Toroq Season 1": [{ title: "Clip 1", views: "Available Soon!" }, { title: "Clip 2", views: "Available Soon!" }],
                "MotorShow DocuSeries": [{ title: "Clip 1", views: "Available Soon!" }, { title: "Clip 2", views: "Available Soon!" }],
                "My Grandfather's Museum Season 1": [{ title: "Clip 1", views: "Available Soon!" }, { title: "Clip 2", views: "Available Soon!" }],
                "Ragel We Set Settat Season 1": [{ title: "Clip 1", views: "Available Soon!" }, { title: "Clip 2", views: "Available Soon!" }],
                "Salon Zahra Season 2": [{ title: "Clip 1", views: "Available Soon!" }, { title: "Clip 2", views: "Available Soon!" }],
                "Shatti Ya Beirut": shortsDataFromImage["Shatti Ya Beirut"],
                "Sikkat Safar Season 1": [{ title: "Clip 1", views: "Available Soon!" }, { title: "Clip 2", views: "Available Soon!" }],
                "Tash: Al Awda Season 19": shortsDataFromImage["Tash: Al Awda Season 19"], // Updated
                "Wlad Badee'a Season 1": shortsDataFromImage["Wlad Badee'a Season 1"], // Updated
                "Zawja Waheda La Takfi Season 1": shortsDataFromImage["Zawja Waheda La Takfi Season 1"]
            };


            const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];

            let averageViewsChart;
            let rangeViewsChart;
            let dailyViewsChart;
            let topTitlesViewsChart; // New chart instance
            let lowAvgViewsChart; // New chart for low performing titles
            let weekComparisonChart; // New chart for week-on-week comparison
            let topTotalViewsChartInstance; // New chart instance for Top 10 Profiles by Total Views

            // Data for the Clip Performance Analysis (Third Party Views - July)
            // Updated based on user provided accurate data
            const thirdPartyJulyProfileData = [
                { name: "Leyla", clips: 20, totalViews: 335596, avgViews: 16779.8 },
                { name: "Al -Meerath", clips: 19, totalViews: 109706, avgViews: 5774.0 },
                { name: "Fareed S3", clips: 17, totalViews: 95585, avgViews: 5622.6 },
                { name: "Al Ameel (Icerde)", clips: 13, totalViews: 82875, avgViews: 6375.0 },
                { name: "Kolna Eyal Qarya", clips: 16, totalViews: 67047, avgViews: 4190.4 },
                { name: "Min Share’ Al Haram Ela... Season 1", clips: 15, totalViews: 47750, avgViews: 3183.3 },
                { name: "Big Time Podcast", clips: 16, totalViews: 44796, avgViews: 2799.8 },
                { name: "Shatti Ya Beirut", clips: 20, totalViews: 41951, avgViews: 2097.6 },
                { name: "Lil Mawt", clips: 18, totalViews: 40959, avgViews: 2275.5 },
                { name: "Al Qadar", clips: 17, totalViews: 35918, avgViews: 2112.8 },
                // Remaining data, not in top 10 by total views but needed for other calculations
                { name: "AL Kha'en", clips: 18, totalViews: 24306, avgViews: 0 },
                { name: "Ahla Ma Tash", clips: 17, totalViews: 30354, avgViews: 0 },
                { name: "Al Hayba", clips: 7, totalViews: 4373, avgViews: 0 },
                { name: "Al Khotta Baa", clips: 13, totalViews: 33551, avgViews: 0 },
                { name: "Al Le'ba: Level Al Wahsh", clips: 19, totalViews: 19985, avgViews: 0 },
                { name: "Amr Ikhlaa S3", clips: 13, totalViews: 14855, avgViews: 0 },
                { name: "Awdat Khalati", clips: 22, totalViews: 24148, avgViews: 0 },
                { name: "Bab Al Hara", clips: 9, totalViews: 2683, avgViews: 0 },
                { name: "Bait & So'al 2025", clips: 3, totalViews: 384, avgViews: 0 }, // Updated name
                { name: "Banat Al Thanawi", clips: 14, totalViews: 20044, avgViews: 0 },
                { name: "Beyt Al Ankaboot", clips: 14, totalViews: 7178, avgViews: 0 },
                { name: "El Hashashin", clips: 19, totalViews: 19483, avgViews: 0 },
                { name: "El Kebeer Awi_TV", clips: 16, totalViews: 717, avgViews: 0 },
                { name: "Gaafar El Omda", clips: 20, totalViews: 23013, avgViews: 0 },
                { name: "Gamgoum Wa Bimbim: Al Sharika Al Almaniya Li Mokafahat Al Khawareq", clips: 5, totalViews: 4058, avgViews: 0 },
                { name: "Horouj", clips: 11, totalViews: 6778, avgViews: 0 },
                { name: "Kermal Al Walad", clips: 11, totalViews: 27929, avgViews: 0 },
                { name: "Mama Ghaneema Season 1", clips: 4, totalViews: 23299, avgViews: 0 },
                { name: "Melh Wa Samra Season 1", clips: 12, totalViews: 9616, avgViews: 0 },
                { name: "Moftaraq Toroq Season 1", clips: 18, totalViews: 22786, avgViews: 0 },
                { name: "MotorShow DocuSeries", clips: 3, totalViews: 17013, avgViews: 0 },
                { name: "My Grandfather's Museum Season 1", clips: 7, totalViews: 14174, avgViews: 0 },
                { name: "Ragel We Set Settat Season 1", clips: 14, totalViews: 10230, avgViews: 0 },
                { name: "Salon Zahra Season 2", clips: 16, totalViews: 22236, avgViews: 0 },
                { name: "Sikkat Safar Season 1", clips: 17, totalViews: 22032, avgViews: 0 },
                { name: "Tash: Al Awda Season 19", clips: 10, totalViews: 433, avgViews: 0 },
                { name: "Top Chef Season 8", clips: 5, totalViews: 10073, avgViews: 0 },
                { name: "Wlad Badee'a Season 1", clips: 21, totalViews: 7647, avgViews: 0 },
                { name: "Zawja Waheda La Takfi Season 1", clips: 4, totalViews: 31297, avgViews: 0 }
            ];

            // Recalculate avgViews for each entry
            thirdPartyJulyProfileData.forEach(item => {
                item.avgViews = item.clips > 0 ? item.totalViews / item.clips : 0;
            });

            const updatedTotalProfiles = 40;
            const updatedTotalClips = 544;
            // Sum total views from the provided thirdPartyJulyProfileData
            const calculatedTotalViews = thirdPartyJulyProfileData.reduce((sum, item) => sum + item.totalViews, 0);


            // July Daily Data - UPDATED WITH NEW DATA FROM IMAGE
            const julyDailyData = [
                { date: 'Jun 30', day: 'Monday', views: 717 },
                { date: 'Jul 1', day: 'Tuesday', views: 815 },
                { date: 'Jul 2', day: 'Wednesday', views: 706 },
                { date: 'Jul 3', day: 'Thursday', views: 676 },
                { date: 'Jul 4', day: 'Friday', views: 698 },
                { date: 'Jul 5', day: 'Saturday', views: 677 },
                { date: 'Jul 6', day: 'Sunday', views: 651 },
                // Week 2 (Jul 7 - Jul 13)
                { date: 'Jul 7', day: 'Monday', views: 680 },
                { date: 'Jul 8', day: 'Tuesday', views: 673 },
                { date: 'Jul 9', day: 'Wednesday', views: 709 },
                { date: 'Jul 10', day: 'Thursday', views: 730 },
                { date: 'Jul 11', day: 'Friday', views: 663 },
                { date: 'Jul 12', day: 'Saturday', views: 655 },
                { date: 'Jul 13', day: 'Sunday', views: 688 },
                // Week 3 (Jul 14 - Jul 20)
                { date: 'Jul 14', day: 'Monday', views: 693 },
                { date: 'Jul 15', day: 'Tuesday', views: 674 },
                { date: 'Jul 16', day: 'Wednesday', views: 624 },
                { date: 'Jul 17', day: 'Thursday', views: 623 },
                { date: 'Jul 18', day: 'Friday', views: 573 },
                { date: 'Jul 19', day: 'Saturday', views: 515 },
                { date: 'Jul 20', day: 'Sunday', views: 537 },
                // Week 4 (Jul 21 - Jul 26/27)
                { date: 'Jul 21', day: 'Monday', views: 593 },
                { date: 'Jul 22', day: 'Tuesday', views: 537 },
                { date: 'Jul 23', day: 'Wednesday', views: 609 },
                { date: 'Jul 24', day: 'Thursday', views: 605 },
                { date: 'Jul 25', day: 'Friday', views: 510 },
                { date: 'Jul 26', day: 'Saturday', views: 410 },
                { date: 'Jul 27', day: 'Sunday', views: 620 } // Keeping previous dummy for Sunday July 27 as image ends on Sat
            ];

            // July Top Titles Data (from image_47207e.png, sorted by Total Views)
            const julyTopTitlesData = [
                { rank: 1, title: "Ommi", views: 3603907, likes: 57078, avgViewsPerClip: 15571 },
                { rank: 2, title: "Al Madeena Al Ba'eeda", views: 2319574, likes: 22672, avgViewsPerClip: 5544 },
                { rank: 3, title: "Fondooq Al Ahlam", views: 1360100, likes: 23218, avgViewsPerClip: 1848 },
                { rank: 4, title: "Leyla", views: 1152671, likes: 18103, avgViewsPerClip: 3510 },
                { rank: 5, title: "FIFA Club World Cup 2025", views: 1072466, likes: 163, avgViewsPerClip: 3443 },
                { rank: 6, title: "Aser", views: 737563, likes: 9699, avgViewsPerClip: 2420 },
                { rank: 7, title: "Holm Esref", views: 633386, likes: 9286, avgViewsPerClip: 3038 },
                { rank: 8, title: "Fareed Season 3", views: 434915, likes: 5786, avgViewsPerClip: 1122 },
                { rank: 9, title: "Harb El Gibali", views: 421705, likes: 2729, avgViewsPerClip: 820 },
                { rank: 10, title: "To Win Or To Win", views: 242256, likes: 1140, avgViewsPerClip: 964 }
            ];


            // Helper function to format large numbers
            function formatViews(views) {
                if (views >= 1000000) {
                    return (views / 1000000).toFixed(2) + 'M+';
                } else if (views >= 1000) {
                    return (views / 1000).toFixed(1) + 'K+';
                }
                return views.toLocaleString();
            }


            const clipPerformancePalette = {
                blueDark: '#005f73',
                blueMid: '#0a9396',
                blueLight: '#94d2bd',
                yellowLight: '#e9d8a6',
                yellowMid: '#ee9b00',
                orangeMid: '#ca6702',
                orangeDark: '#bb3e03',
                redMid: '#ae2012',
                redDark: '#9b2226'
            };

            const clipPerformanceChartColors = [clipPerformancePalette.blueMid, clipPerformancePalette.yellowMid, clipPerformancePalette.orangeMid, clipPerformancePalette.blueLight, clipPerformancePalette.redMid, clipPerformancePalette.blueDark, clipPerformancePalette.orangeDark, clipPerformancePalette.yellowLight, clipPerformancePalette.redDark, clipPerformancePalette.blueMid];


            const processOverallData = (data) => {
                const viewsByDay = {};
                dayNames.forEach(day => viewsByDay[day] = []); // Initialize all days
                data.forEach(d => {
                    if (viewsByDay[d.day]) { // Ensure day exists
                        viewsByDay[d.day].push(d.views);
                    }
                });

                const avgData = dayNames.map(day => {
                    const views = viewsByDay[day] || [];
                    return views.length > 0 ? views.reduce((sum, v) => sum + v, 0) / views.length : 0;
                });

                const rangeData = dayNames.map(day => {
                    const views = viewsByDay[day] || [];
                    if (views.length === 0) return [0, 0];
                    return [Math.min(...views), Math.max(...views)];
                });

                return { labels: dayNames, avgData, rangeData };
            };

            const processDailyDataForWeek = (data, weekNumber) => {
                let dataSubset = [];
                // Correct slicing for 7-day weeks
                const startIndex = (weekNumber - 1) * 7;
                dataSubset = data.slice(startIndex, startIndex + 7);

                if (dataSubset.length === 0) {
                    return { labels: ["No data available"], views: [0], rawData: [] };
                }
                const labels = dataSubset.map(d => `${d.date} (${d.day.substring(0, 3)})`);
                const views = dataSubset.map(d => d.views);
                return { labels, views, rawData: dataSubset };
            };

            const updateKPIs = (data, prefix = '') => {
                // Check if the elements exist before trying to update them
                const kpiHighestElem = document.getElementById(`${prefix}KpiHighest`);
                const kpiHighestDayElem = document.getElementById(`${prefix}KpiHighestDay`);
                const kpiLowestElem = document.getElementById(`${prefix}KpiLowest`);
                const kpiLowestDayElem = document.getElementById(`${prefix}KpiLowestDay`);
                const kpiMidWeekAvgElem = document.getElementById(`${prefix}KpiMidWeekAvg`);
                const kpiWeekendAvgElem = document.getElementById(`${prefix}KpiWeekendAvg`);
                const kpiTotalViewsElem = document.getElementById(`${prefix}KpiTotalViews`); // New element

                if (!kpiHighestElem || !kpiHighestDayElem || !kpiLowestElem || !kpiLowestDayElem || !kpiMidWeekAvgElem || !kpiWeekendAvgElem || (prefix === 'july' && !kpiTotalViewsElem)) {
                    console.warn(`KPI elements with prefix '${prefix}' not found. Skipping KPI update.`);
                    return;
                }

                if (data.length === 0) {
                    kpiHighestElem.textContent = 'N/A';
                    kpiHighestDayElem.textContent = '';
                    kpiLowestElem.textContent = 'N/A';
                    kpiLowestDayElem.textContent = '';
                    kpiMidWeekAvgElem.textContent = 'N/A';
                    kpiWeekendAvgElem.textContent = 'N/A';
                    if (kpiTotalViewsElem) kpiTotalViewsElem.textContent = 'N/A';
                    return;
                }

                let highestView = 0;
                let highestDay = '';
                let lowestView = Infinity;
                let lowestDay = '';
                let totalViews = 0; // Initialize total views

                data.forEach(d => {
                    if (d.views > highestView) {
                        highestView = d.views;
                        highestDay = `${d.date} (${d.day})`;
                    }
                    if (d.views < lowestView) {
                        lowestView = d.views;
                        lowestDay = `${d.date} (${d.day})`;
                    }
                    totalViews += d.views; // Accumulate total views
                });

                const midWeekViews = data.filter(d => ['Tuesday', 'Wednesday', 'Thursday'].includes(d.day)).map(d => d.views);
                const weekendViews = data.filter(d => ['Saturday', 'Sunday'].includes(d.day)).map(d => d.views);

                const avgMidWeek = midWeekViews.length > 0 ? midWeekViews.reduce((sum, v) => sum + v, 0) / midWeekViews.length : 0;
                const avgWeekend = weekendViews.length > 0 ? weekendViews.reduce((sum, v) => sum + v, 0) / weekendViews.length : 0;

                kpiHighestElem.textContent = `${highestView}K`;
                kpiHighestDayElem.textContent = `on ${highestDay}`;
                kpiLowestElem.textContent = `${lowestView}K`;
                kpiLowestDayElem.textContent = `on ${lowestDay}`;
                kpiMidWeekAvgElem.textContent = `${avgMidWeek.toFixed(0)}K`;
                kpiWeekendAvgElem.textContent = `${avgWeekend.toFixed(0)}K`;
                
                if (kpiTotalViewsElem) {
                    if (prefix === 'july') {
                        // For July total views, format to Millions with truncation
                        const totalViewsInMillions = (Math.floor(totalViews / 100) / 10).toFixed(1);
                        kpiTotalViewsElem.textContent = `${totalViewsInMillions}M`;
                    } else {
                        kpiTotalViewsElem.textContent = `${totalViews.toLocaleString()}K`;
                    }
                }
            };

            const chartClickHandler = (evt, elements, chart) => {
                if (elements.length > 0) {
                    const dataIndex = elements[0].index;
                    const clickedLabel = chart.data.labels[dataIndex];
                    let targetDayFull;

                    if (clickedLabel.includes('(') && clickedLabel.includes(')')) {
                        // Format: "Jun 1 (Sun)"
                        const dayAbbr = clickedLabel.match(/\((.*?)\)/)[1];
                        targetDayFull = dayNames.find(d => d.startsWith(dayAbbr));
                    } else {
                        // Format: "Sunday"
                        targetDayFull = clickedLabel;
                    }
                    
                    const recommendations = document.querySelectorAll('.accordion-item');
                    recommendations.forEach(rec => {
                        const recDays = rec.dataset.day.split(',');
                        if (recDays.includes(targetDayFull)) {
                            rec.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            rec.classList.add('highlight');
                            const accordionHeader = rec.querySelector('.accordion-header');
                            const accordionContent = rec.querySelector('.accordion-content');
                            if (accordionContent.style.maxHeight) {
                                // Already open, just highlight
                            } else {
                                accordionHeader.click();
                            }
                            setTimeout(() => rec.classList.remove('highlight'), 1500);
                        }
                    });
                }
            };

            const createChart = (ctx, type, data, options) => {
                return new Chart(ctx, { type, data, options });
            };

            const baseOptions = {
                maintainAspectRatio: false,
                responsive: true,
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        backgroundColor: '#0f172a', // slate-900
                        titleFont: { weight: 'bold' },
                        bodyFont: { size: 14 },
                        padding: 12,
                        cornerRadius: 8,
                        displayColors: false,
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: {
                            color: '#e2e8f0' // slate-200
                        },
                        ticks: {
                            color: '#64748b', // slate-500
                            callback: function(value) {
                                return value + 'K';
                            }
                        },
                        title: {
                            display: true,
                            text: 'Views (in Thousands)',
                            color: '#475569', // slate-600
                            font: {
                                weight: 'semibold'
                            }
                        }
                    },
                    x: {
                        grid: {
                            display: false
                        },
                        ticks: {
                             color: '#64748b' // slate-500
                        }
                    }
                }
            };

            // Initialize Overall Charts (Average and Range) - June
            const avgCtx = document.getElementById('averageViewsChart').getContext('2d');
            const avgChartOptions = {
                ...baseOptions,
                onClick: chartClickHandler,
                plugins: {
                    ...baseOptions.plugins,
                    tooltip: {
                        ...baseOptions.plugins.tooltip,
                        callbacks: {
                            label: function(context) {
                                return `Avg. Views: ${context.parsed.y.toFixed(0)}K`;
                            }
                        }
                    }
                }
            };
            averageViewsChart = createChart(avgCtx, 'bar', {
                labels: processOverallData(fullDailyData).labels,
                datasets: [{
                    label: 'Average Views',
                    data: processOverallData(fullDailyData).avgData,
                    backgroundColor: 'rgba(14, 165, 233, 0.6)', // sky-500
                    borderColor: 'rgba(14, 165, 233, 1)',
                    borderWidth: 2,
                    borderRadius: 4,
                }]
            }, avgChartOptions);

            const rangeCtx = document.getElementById('rangeViewsChart').getContext('2d');
            const rangeChartOptions = {
                 ...baseOptions,
                onClick: chartClickHandler,
                scales: {
                    ...baseOptions.scales,
                    y: {
                        ...baseOptions.scales.y,
                        beginAtZero: false
                    }
                },
                plugins: {
                     ...baseOptions.plugins,
                    tooltip: {
                         ...baseOptions.plugins.tooltip,
                         callbacks: {
                            label: function(context) {
                                const range = context.raw;
                                return `Views Range: ${range[0]}K - ${range[1]}K`;
                            }
                        }
                    }
                }
            };
            rangeViewsChart = createChart(rangeCtx, 'bar', {
                labels: processOverallData(fullDailyData).labels,
                datasets: [{
                    label: 'Viewership Range',
                    data: processOverallData(fullDailyData).rangeData,
                    backgroundColor: 'rgba(245, 158, 11, 0.6)', // amber-500
                    borderColor: 'rgba(245, 158, 11, 1)',
                    borderWidth: 2,
                    borderRadius: 4,
                    borderSkipped: false,
                }]
            }, rangeChartOptions);

            // Initialize Daily Views Chart - June
            const dailyCtx = document.getElementById('dailyViewsChart').getContext('2d');
            const dailyChartOptions = {
                ...baseOptions,
                onClick: chartClickHandler,
                plugins: {
                    ...baseOptions.plugins,
                    tooltip: {
                        ...baseOptions.plugins.tooltip,
                        callbacks: {
                            label: function(context) {
                                return `Daily Views: ${context.parsed.y.toFixed(0)}K`;
                            }
                        }
                    }
                },
                scales: {
                    ...baseOptions.scales,
                    x: {
                        ...baseOptions.scales.x,
                        ticks: {
                            color: '#64748b',
                            maxRotation: 45,
                            minRotation: 45
                        }
                    }
                }
            };
            dailyViewsChart = createChart(dailyCtx, 'bar', {
                labels: [],
                datasets: [{
                    label: 'Daily Views',
                    data: [],
                    backgroundColor: 'rgba(16, 185, 129, 0.6)', // emerald-500
                    borderColor: 'rgba(16, 185, 129, 1)',
                    borderWidth: 2,
                    borderRadius: 4,
                }]
            }, dailyChartOptions);

            // Initial data for Top Titles Chart - June
            const initialTopTitlesLabels = top10TitlesData.map(item => item.title);
            const initialTopTitlesViews = top10TitlesData.map(item => parseFloat(item.views.replace('M', '')) * 1000000);

            // Initialize Top Titles Views Chart - June
            const topTitlesCtx = document.getElementById('topTitlesViewsChart').getContext('2d');
            const topTitlesChartOptions = {
                ...baseOptions,
                indexAxis: 'y', // Make it a horizontal bar chart
                scales: {
                    x: {
                        beginAtZero: true,
                        grid: {
                            color: '#e2e8f0'
                        },
                        ticks: {
                            color: '#64748b',
                            callback: function(value) {
                                // Convert to millions for display
                                return (value / 1000000) + 'M';
                            }
                        },
                        title: {
                            display: true,
                            text: 'Total Views',
                            color: '#475569',
                            font: {
                                weight: 'semibold'
                            }
                        }
                    },
                    y: {
                        grid: {
                            display: false
                        },
                        ticks: {
                            color: '#64748b'
                        }
                    }
                },
                plugins: {
                    ...baseOptions.plugins,
                    tooltip: {
                        ...baseOptions.plugins.tooltip,
                        callbacks: {
                            label: function(context) {
                                return `Total Views: ${context.parsed.x / 1000000}M`;
                            }
                        }
                    }
                },
                // Added options for bar thickness
                barThickness: 30, // Fixed thickness for bars
                categoryPercentage: 0.8, // Adjust space between bars
                barPercentage: 0.9, // Adjust width of the bar itself
                onClick: (evt, elements) => { // Custom onClick for topTitlesViewsChart
                    showDebugMessage("Chart click event triggered on June Top Titles Chart.");
                    if (elements.length > 0) {
                        const dataIndex = elements[0].index;
                        const clickedTitleRaw = topTitlesViewsChart.data.labels[dataIndex];
                        // If the label is an array (from formatClipLabel), join it back to a string
                        const clickedTitle = Array.isArray(clickedTitleRaw) ? clickedTitleRaw.join(' ') : clickedTitleRaw;
                        showDebugMessage("Clicked title on June Top Titles Chart: " + clickedTitle);
                        // This chart no longer triggers the Leyla modal directly.
                        // It will just filter the chart to show only the clicked title.
                        const titleData = top10TitlesData.find(t => t.title === clickedTitle);
                        if (titleData) {
                            displaySingleTitleOnChart(titleData.title, titleData.views);
                        }
                    } else {
                        showDebugMessage("No element clicked on June Top Titles Chart.");
                    }
                }
            };

            topTitlesViewsChart = createChart(topTitlesCtx, 'bar', {
                labels: initialTopTitlesLabels,
                datasets: [{
                    label: 'Total Views',
                    data: initialTopTitlesViews,
                    backgroundColor: 'rgba(79, 70, 229, 0.6)', // indigo-500
                    borderColor: 'rgba(79, 70, 229, 1)',
                    borderWidth: 2,
                    borderRadius: 4,
                }]
            }, topTitlesChartOptions);

            // Function to update Top Titles Chart for a single title
            const displaySingleTitleOnChart = (title, views) => {
                topTitlesViewsChart.data.labels = [title];
                topTitlesViewsChart.data.datasets[0].data = [parseFloat(views.replace('M', '')) * 1000000];
                topTitlesViewsChart.update();
            };

            // Function to display all titles on the chart
            const displayAllTitlesOnChart = () => {
                topTitlesViewsChart.data.labels = initialTopTitlesLabels;
                topTitlesViewsChart.data.datasets[0].data = initialTopTitlesViews;
                topTitlesViewsChart.update();
            };


            const updateDailyViewsChart = (data, chartInstance, weekNumber) => {
                const processedDailyData = processDailyDataForWeek(data, weekNumber);
                chartInstance.data.labels = processedDailyData.labels;
                chartInstance.data.datasets[0].data = processedDailyData.views;
                chartInstance.update();
            };

            // Tab functionality for Overall Chart Type (Average vs. Range) - June
            const avgBtn = document.getElementById('avgBtn');
            const rangeBtn = document.getElementById('rangeBtn');
            const avgChartContainer = document.getElementById('avgChartContainer');
            const rangeChartContainer = document.getElementById('rangeChartContainer');

            // Check if these elements exist before adding listeners
            if (avgBtn && rangeBtn && avgChartContainer && rangeChartContainer) {
                avgBtn.addEventListener('click', () => {
                    avgChartContainer.classList.remove('hidden');
                    rangeChartContainer.classList.add('hidden');
                    avgBtn.classList.add('bg-white', 'text-sky-600', 'shadow-sm', 'font-semibold');
                    avgBtn.classList.remove('text-slate-600', 'font-medium');
                    rangeBtn.classList.remove('bg-white', 'text-sky-600', 'shadow-sm', 'font-semibold');
                    rangeBtn.classList.add('text-slate-600', 'font-medium');
                });

                rangeBtn.addEventListener('click', () => {
                    rangeChartContainer.classList.remove('hidden');
                    avgChartContainer.classList.add('hidden');
                    rangeBtn.classList.add('bg-white', 'text-sky-600', 'shadow-sm', 'font-semibold');
                    rangeBtn.classList.remove('text-slate-600', 'font-medium');
                    avgBtn.classList.remove('bg-white', 'text-sky-600', 'shadow-sm', 'font-semibold');
                    avgBtn.classList.add('text-slate-600', 'font-medium');
                });
            }
            
            // Tab functionality for Weekly Daily Data - June
            const weeklyDailyButtons = document.querySelectorAll('.weekly-daily-btn');
            const dailyChartSection = document.getElementById('dailyChartContainer'); // Get the chart container

            weeklyDailyButtons.forEach(button => {
                button.addEventListener('click', () => {
                    weeklyDailyButtons.forEach(btn => {
                        btn.classList.remove('bg-white', 'text-sky-600', 'shadow-sm', 'font-semibold');
                        btn.classList.add('text-slate-600', 'font-medium');
                    });
                    button.classList.add('bg-white', 'text-sky-600', 'shadow-sm', 'font-semibold');
                    button.classList.remove('text-slate-600', 'font-medium');

                    let selectedWeek = parseInt(button.id.replace('week', '').replace('DailyBtn', ''));
                    
                    // Show the chart container when a button is clicked
                    if (dailyChartSection) {
                        dailyChartSection.classList.remove('hidden');
                    }
                    updateDailyViewsChart(fullDailyData, dailyViewsChart, selectedWeek);
                });
            });

            // Top-level Main Tab functionality (for Monthly Highlights, Top 10 Titles, Recommendation Titles) - June
            const mainTabButtons = document.querySelectorAll('.main-tab-btn');
            const mainContentSections = document.querySelectorAll('.main-content-section');

            mainTabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    // Deactivate all main tab buttons
                    mainTabButtons.forEach(btn => {
                        btn.classList.remove('bg-white', 'text-sky-600', 'shadow-sm', 'font-semibold');
                        btn.classList.add('text-slate-600', 'font-medium');
                    });

                    // Activate clicked button
                    button.classList.add('bg-white', 'text-sky-600', 'shadow-sm', 'font-semibold');
                    button.classList.remove('text-slate-600', 'font-medium');

                    // Hide all content sections
                    mainContentSections.forEach(section => {
                        section.classList.add('hidden');
                    });

                    // Show the target section
                    const targetSectionId = button.dataset.target;
                    const sectionToShow = document.getElementById(targetSectionId);
                    if (sectionToShow) {
                        sectionToShow.classList.remove('hidden');

                        // Specific update for the Top 10 Titles chart when its section becomes visible
                        if (targetSectionId === 'top-titles-section' && topTitlesViewsChart) {
                            // Use a small timeout to ensure the canvas is fully visible before resizing
                            setTimeout(() => {
                                const canvasElement = topTitlesViewsChart.canvas;
                                if (canvasElement && canvasElement.offsetParent !== null) { // Check if canvas is visible
                                    topTitlesViewsChart.resize();
                                    topTitlesViewsChart.update();
                                    showDebugMessage("Top Titles Chart resized and updated after tab switch.");
                                } else {
                                    showDebugMessage("Top Titles Chart canvas not visible for resize.");
                                }
                            }, 100); // Increased delay
                        }
                    }
                });
            });


            // Accordion functionality
            document.querySelectorAll('.accordion-header').forEach(header => {
                header.addEventListener('click', () => {
                    const content = header.nextElementSibling;
                    const icon = header.querySelector('span');
                    const llmResponseDiv = content.querySelector('.llm-response');
                    const generatedTextP = llmResponseDiv ? llmResponseDiv.querySelector('.generated-text') : null;


                    // Close all others
                    document.querySelectorAll('.accordion-content').forEach(c => {
                        if (c !== content) {
                            c.style.maxHeight = null;
                            const otherIcon = c.previousElementSibling ? c.previousElementSibling.querySelector('span') : null;
                            if (otherIcon) {
                                otherIcon.classList.remove('rotate-180');
                            }
                             // Clear LLM response when collapsing other items
                            const otherLlmResponseDiv = c.querySelector('.llm-response');
                            if (otherLlmResponseDiv) {
                                otherLlmResponseDiv.classList.add('hidden');
                                const otherGeneratedTextP = otherLlmResponseDiv.querySelector('.generated-text');
                                if (otherGeneratedTextP) {
                                    otherGeneratedTextP.textContent = '';
                                    otherGeneratedTextP.classList.remove('text-red-500');
                                }
                            }
                        }
                    });

                    // Toggle current
                    if (content.style.maxHeight) {
                        content.style.maxHeight = null;
                        icon.classList.remove('rotate-180');
                         // Clear LLM response when collapsing current item
                        if (llmResponseDiv) {
                            llmResponseDiv.classList.add('hidden');
                            if (generatedTextP) {
                                generatedTextP.textContent = '';
                                generatedTextP.classList.remove('text-red-500');
                            }
                        }
                    } else {
                        content.style.maxHeight = content.scrollHeight + 'px';
                        icon.classList.add('rotate-180');
                    }
                });
            });

            // Function to populate the Top 10 Titles table - June
            const populateTopTitlesTable = () => {
                const tableBody = document.getElementById('topTitlesTableBody');
                if (!tableBody) return; // Exit if element not found
                tableBody.innerHTML = ''; // Clear existing rows

                top10TitlesData.forEach(item => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td class="px-4 py-2 whitespace-nowrap">${item.rank}</td>
                        <td class="px-4 py-2 whitespace-nowrap">${item.title}</td>
                        <td class="px-4 py-2 whitespace-nowrap">${item.views}</td>
                        <td class="px-4 py-2 whitespace-nowrap">${item.likes}</td>
                        <td class="px-4 py-2 whitespace-nowrap">${item.avgViewsPerClip}</td>
                    `;
                    // Add click listener to each row
                    row.addEventListener('click', () => {
                        showDebugMessage("Table row click event triggered for: " + item.title + " (June Top Titles)");
                        // This chart no longer triggers the Leyla modal directly.
                        displaySingleTitleOnChart(item.title, item.views);
                    });
                    tableBody.appendChild(row);
                });
            };

            // Event listener for "Show All Titles" button - June
            const showAllTitlesBtn = document.getElementById('showAllTitlesBtn');
            if (showAllTitlesBtn) {
                showAllTitlesBtn.addEventListener('click', displayAllTitlesOnChart);
            }

            // New Top-Level Report Navigation Logic (for June/July Performance, DMCS, Third Party, Additional Insights)
            const reportNavButtons = document.querySelectorAll('.report-nav-btn');
            const reportContentSections = document.querySelectorAll('.report-content-section');

            reportNavButtons.forEach(button => {
                button.addEventListener('click', (event) => {
                    const targetSectionId = button.dataset.target; // For internal section toggling

                    // Deactivate all report nav buttons that toggle sections
                    reportNavButtons.forEach(btn => {
                        btn.classList.remove('bg-sky-600', 'text-white', 'shadow-sm', 'font-semibold');
                        btn.classList.add('bg-slate-200', 'text-slate-800', 'font-medium', 'hover:bg-slate-300');
                    });

                    // Activate clicked button visually
                    button.classList.add('bg-sky-600', 'text-white', 'shadow-sm', 'font-semibold');
                    button.classList.remove('bg-slate-200', 'text-slate-800', 'font-medium', 'hover:bg-slate-300');

                    // Hide all report content sections
                    reportContentSections.forEach(section => {
                        section.classList.add('hidden');
                    });

                    // Show the target report content section
                    const sectionToShow = document.getElementById(targetSectionId);
                    if (sectionToShow) {
                        sectionToShow.classList.remove('hidden');
                        // If it's the third-party-july-content, initialize its charts and generate recommendations
                        if (targetSectionId === 'third-party-july-content') {
                            showDebugMessage("Navigated to Third Party Views - July. Initializing charts.");
                            // Update KPIs for Third Party Views - July
                            document.getElementById('total-profiles').textContent = updatedTotalProfiles;
                            document.getElementById('total-clips').textContent = updatedTotalClips;
                            document.getElementById('total-views').textContent = formatViews(calculatedTotalViews); // Use the formatViews function

                            // Increased timeout to give the browser more time to render elements
                            setTimeout(() => { 
                                initializeThirdPartyJulyCharts();
                                populateLowTitlesTable(); // Populate low titles table
                                populateTopTotalViewsTable(); // Populate the new table
                            }, 500); // Increased timeout to 500ms
                        } else if (targetSectionId === 'july-report-content') {
                            showDebugMessage("Navigated to July Performance Analysis. Initializing July charts.");
                            // Activate the first tab within the July report by default
                            const julyDashboardTabBtn = document.getElementById('julyDashboardTabBtn');
                            if (julyDashboardTabBtn) {
                                julyDashboardTabBtn.click(); // Simulate click to activate and show dashboard
                            }
                        } else if (targetSectionId === 'additional-insights-content') {
                            showDebugMessage("Navigated to Additional Insights. Initializing week comparison chart.");
                            initializeWeekComparisonChart();
                        } else {
                            showDebugMessage(`Navigated to ${targetSectionId}.`);
                        }
                    }
                });
            });

            // Add event listeners for the DMCS dropdown menu items
            document.querySelectorAll('.dropdown-menu-item').forEach(item => {
                item.addEventListener('click', (event) => {
                    event.preventDefault(); // Prevent default link behavior
                    const targetSectionId = event.target.dataset.targetSection;
                    showDebugMessage(`Clicked DMCS dropdown item: ${targetSectionId}`);

                    // Deactivate all report nav buttons
                    reportNavButtons.forEach(btn => {
                        btn.classList.remove('bg-sky-600', 'text-white', 'shadow-sm', 'font-semibold');
                        btn.classList.add('bg-slate-200', 'text-slate-800', 'font-medium', 'hover:bg-slate-300');
                    });

                    // Activate the DMCS Views button visually
                    const dmcsViewsBtn = document.getElementById('dmcsViewsBtn');
                    if (dmcsViewsBtn) {
                        dmcsViewsBtn.classList.add('bg-sky-600', 'text-white', 'shadow-sm', 'font-semibold');
                        dmcsViewsBtn.classList.remove('bg-slate-200', 'text-slate-800', 'font-medium', 'hover:bg-slate-300');
                    }

                    // Hide all report content sections
                    reportContentSections.forEach(section => {
                        section.classList.add('hidden');
                    });

                    // Show the target DMCS content section
                    const sectionToShow = document.getElementById(targetSectionId);
                    if (sectionToShow) {
                        sectionToShow.classList.remove('hidden');
                    }
                });
            });

            // Event listeners for Third Party Overview month buttons (NEWLY ADDED)
            document.querySelectorAll('.third-party-month-btn').forEach(button => {
                button.addEventListener('click', () => {
                    const targetSectionId = button.dataset.targetSection;
                    showDebugMessage(`Clicked Third Party month button: ${targetSectionId}`);
                    
                    // Hide all report content sections
                    reportContentSections.forEach(section => {
                        section.classList.add('hidden');
                    });

                    // Show the target section
                    const sectionToShow = document.getElementById(targetSectionId);
                    if (sectionToShow) {
                        sectionToShow.classList.remove('hidden');
                        // If it's the third-party-july-content, initialize its charts and generate recommendations
                        if (targetSectionId === 'third-party-july-content') {
                            showDebugMessage("Navigated to Third Party Views - July from month button. Initializing charts.");
                            // Update KPIs for Third Party Views - July
                            document.getElementById('total-profiles').textContent = updatedTotalProfiles;
                            document.getElementById('total-clips').textContent = updatedTotalClips;
                            document.getElementById('total-views').textContent = formatViews(calculatedTotalViews); // Use the formatViews function

                            setTimeout(() => { 
                                initializeThirdPartyJulyCharts();
                                populateLowTitlesTable(); // Populate low titles table
                                populateTopTotalViewsTable(); // Populate the new table
                            }, 500); // Increased timeout to 500ms
                        }
                    }
                });
            });

            // Event listeners for "Back to Dashboard" buttons within sections
            document.querySelectorAll('.back-to-main-dashboard').forEach(button => {
                button.addEventListener('click', () => {
                    showDebugMessage("Clicked 'Back to Dashboard' button.");
                    // Hide all report content sections
                    reportContentSections.forEach(section => {
                        section.classList.add('hidden');
                    });
                    // Show the main dashboard content (June Performance Analysis)
                    const juneReportContent = document.getElementById('june-report-content');
                    if (juneReportContent) {
                        juneReportContent.classList.remove('hidden');
                    }

                    // Reset active state for top-level nav buttons
                    reportNavButtons.forEach(btn => {
                        btn.classList.remove('bg-sky-600', 'text-white', 'shadow-sm', 'font-semibold');
                        btn.classList.add('bg-slate-200', 'text-slate-800', 'font-medium', 'hover:bg-slate-300');
                    });
                    const juneReportBtn = document.getElementById('juneReportBtn');
                    if (juneReportBtn) {
                        juneReportBtn.classList.add('bg-sky-600', 'text-white', 'shadow-sm', 'font-semibold');
                        juneReportBtn.classList.remove('bg-slate-200', 'text-slate-800', 'font-medium', 'hover:bg-slate-300');
                    }
                });
            });


            // Function to initialize charts for Third Party Views - July
            function initializeThirdPartyJulyCharts() {
                showDebugMessage("Running initializeThirdPartyJulyCharts().");
                // Destroy existing chart instances if they exist to prevent duplicates
                if (window.totalViewsChartInstance) {
                    window.totalViewsChartInstance.destroy();
                    showDebugMessage("Destroyed existing totalViewsChartInstance.");
                }
                if (window.avgViewsChartInstance) {
                    window.avgViewsChartInstance.destroy();
                    showDebugMessage("Destroyed existing avgViewsChartInstance.");
                }
                if (window.lowAvgViewsChartInstance) {
                    window.lowAvgViewsChartInstance.destroy();
                    showDebugMessage("Destroyed existing lowAvgViewsChartInstance.");
                }
                if (topTotalViewsChartInstance) { // Destroy the new chart instance
                    topTotalViewsChartInstance.destroy();
                    showDebugMessage("Destroyed existing topTotalViewsChartInstance.");
                }

                // Ensure canvases exist and their getContext method is available before trying to get context
                const totalViewsCanvas = document.getElementById('totalViewsChart');
                const avgViewsCanvas = document.getElementById('avgViewsChart');
                const lowAvgViewsCanvas = document.getElementById('lowAvgViewsChart'); // New chart context
                const topTotalViewsCanvas = document.getElementById('topTotalViewsChart'); // New canvas for the top total views chart

                const totalViewsCtx = totalViewsCanvas && totalViewsCanvas.getContext ? totalViewsCanvas.getContext('2d') : null;
                const avgViewsCtx = avgViewsCanvas && avgViewsCanvas.getContext ? avgViewsCanvas.getContext('2d') : null;
                const lowAvgViewsCtx = lowAvgViewsCanvas && lowAvgViewsCanvas.getContext ? lowAvgViewsCanvas.getContext('2d') : null;
                const topTotalViewsCtx = topTotalViewsCanvas && topTotalViewsCanvas.getContext ? topTotalViewsCanvas.getContext('2d') : null; // Get context for the new chart

                if (!totalViewsCtx || !avgViewsCtx || !lowAvgViewsCtx || !topTotalViewsCtx) {
                    showDebugMessage("ERROR: One or more chart canvases for Third Party Views - July not found or not ready.");
                    return;
                }

                const formatClipLabel = (label, charLimit = 16) => {
                    if (typeof label !== 'string' || label.length <= charLimit) {
                        return label;
                    }
                    const words = label.split(' ');
                    const lines = [];
                    let currentLine = '';
                    for (const word of words) {
                        if ((currentLine + ' ' + word).length > charLimit) {
                            lines.push(currentLine.trim());
                            currentLine = word;
                        } else {
                            currentLine += (currentLine ? ' ' : '') + word;
                        }
                    }
                    if (currentLine) {
                        lines.push(currentLine.trim());
                    }
                    return lines;
                };

                const clipSharedTooltipConfig = {
                    plugins: {
                        tooltip: {
                            callbacks: {
                                title: function(tooltipItems) {
                                    const item = tooltipItems[0];
                                    let label = item.chart.data.labels[item.dataIndex];
                                    return Array.isArray(label) ? label.join(' ') : label;
                                }
                            }
                        }
                    }
                };

                // Chart for Top 10 Profiles by Total Views (from image)
                const sortedByTotalViews = [...thirdPartyJulyProfileData].sort((a, b) => b.totalViews - a.totalViews).slice(0, 10);
                topTotalViewsChartInstance = new Chart(topTotalViewsCtx, {
                    type: 'bar',
                    data: {
                        labels: sortedByTotalViews.map(p => formatClipLabel(p.name, 20)),
                        datasets: [{
                            label: 'Total Views',
                            data: sortedByTotalViews.map(p => p.totalViews),
                            backgroundColor: clipPerformanceChartColors,
                            borderColor: 'rgba(255, 255, 255, 0.2)',
                            borderWidth: 1
                        }]
                    },
                    options: { ...clipSharedTooltipConfig,
                        indexAxis: 'y', // Horizontal bar chart
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { ...clipSharedTooltipConfig.plugins,
                            legend: { display: false },
                            title: { display: true, text: 'Champions of Reach: Top 10 by Total Views', font: { size: 16 }, color: clipPerformancePalette.blueDark }
                        },
                        scales: {
                            x: {
                                beginAtZero: true,
                                title: { display: true, text: 'Total Views' },
                                grid: { color: '#e5e7eb' },
                                ticks: {
                                    callback: function(value) {
                                        // Format x-axis labels to K or M
                                        if (value >= 1000000) return (value / 1000000) + 'M';
                                        if (value >= 1000) return (value / 1000) + 'K';
                                        return value;
                                    }
                                }
                            },
                            y: { grid: { display: false } }
                        },
                        onClick: (evt, elements) => {
                            showDebugMessage("Chart click event triggered on July Top Total Views Chart.");
                            if (elements.length > 0) {
                                const dataIndex = elements[0].index;
                                const clickedTitleRaw = topTotalViewsChartInstance.data.labels[dataIndex];
                                const originalTitleObject = sortedByTotalViews[dataIndex];
                                const originalTitleName = originalTitleObject ? originalTitleObject.name : (Array.isArray(clickedTitleRaw) ? clickedTitleRaw.join(' ') : clickedTitleRaw);
                                
                                showDebugMessage("Clicked title on July Top Total Views Chart: " + originalTitleName);

                                if (allTitlesShortsData[originalTitleName]) {
                                    showDebugMessage(`Calling showShortsModal for ${originalTitleName} from July Top Total Views Chart click.`);
                                    showShortsModal(originalTitleName, allTitlesShortsData[originalTitleName]);
                                } else {
                                    showDebugMessage(`No specific shorts data found for ${originalTitleName}. Showing empty modal.`);
                                    showShortsModal(originalTitleName, []);
                                }
                            } else {
                                showDebugMessage("No element clicked on July Top Total Views Chart.");
                            }
                        }
                    }
                });


                // Original totalViewsChart (now renamed to avoid confusion, perhaps 'overallTotalViewsChart' or similar if needed)
                // This one is still present in the HTML as 'totalViewsChart'
                // For now, I'll keep the original 'totalViewsChartInstance' name for the first chart in the "Viewership Trends" section
                // If the user wants to remove the first "Total Views Chart" in favor of the new one, I'll adjust.
                // Based on the image, the 'totalViewsChart' (first one in Viewership Trends) should probably be removed or repurposed.
                // For now, I'll assume the user wants the "Top 10 Profiles by Total Views" chart to be the *new* one, and the existing `totalViewsChart` is separate.
                // However, the prompt implies "top 10 profiles by total views should be like that", referring to the image.
                // This means the existing `totalViewsChart` should *become* the one from the image.
                // Let's rename the existing `totalViewsChart` to `top10ProfilesTotalViewsChart` and use it.
                // No, the image shows "Top 10 Profiles by Total Views" as a horizontal bar chart, and the existing `totalViewsChart` is a vertical bar chart.
                // The user's request is to make the "top 10 profiles by total views" section *look like that*.
                // This implies the chart in the image should be the one in the "Top 10 Profiles by Total Views" section.
                // So, I should create a new chart instance for `topTotalViewsChart` and remove the `totalViewsChartInstance` from the `Viewership Trends` section, or clarify its purpose.

                // Let's assume the user wants the chart from the image to replace the first chart in the "Viewership Trends" section.
                // This means the canvas with id `totalViewsChart` should be used for the chart from the image.
                // And the section "Top 10 Profiles by Total Views" should contain this chart.

                // Re-evaluating: The user's screenshot shows "Top 10 Profiles by Total Views" *within* the "Third Party Views - July 2025" page.
                // My current HTML has a `totalViewsChart` and `avgViewsChart` under "Viewership Trends".
                // And then a "Top Total Views Table Section" which *should* contain the chart from the image.
                // So, I should use `topTotalViewsChart` for the chart from the image.
                // The `totalViewsChart` and `avgViewsChart` under "Viewership Trends" are separate.

                // So, the `topTotalViewsChartInstance` is correctly placed.
                // I will now ensure the `totalViewsChartInstance` and `avgViewsChartInstance` are distinct and correctly configured for their respective sections.

                // The existing `totalViewsChartInstance` (first chart under "Viewership Trends")
                // Let's re-initialize it to ensure it's distinct.
                window.totalViewsChartInstance = new Chart(totalViewsCtx, {
                    type: 'bar', // This is still a vertical bar chart for general viewership trends
                    data: {
                        labels: thirdPartyJulyProfileData.map(p => formatClipLabel(p.name, 10)), // Shorter labels for vertical bars
                        datasets: [{
                            label: 'Total Views',
                            data: thirdPartyJulyProfileData.map(p => p.totalViews),
                            backgroundColor: clipPerformanceChartColors,
                            borderColor: 'rgba(255, 255, 255, 0.2)',
                            borderWidth: 1
                        }]
                    },
                    options: { ...clipSharedTooltipConfig,
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { ...clipSharedTooltipConfig.plugins,
                            legend: { display: false },
                            title: { display: true, text: 'Profiles by Total Views (All)', font: { size: 16 }, color: clipPerformancePalette.blueDark }
                        },
                        scales: {
                            x: { grid: { display: false } },
                            y: { title: { display: true, text: 'Total Views' }, grid: { color: '#e5e7eb' } }
                        }
                    }
                });
                
                const sortedByAvgViews = [...thirdPartyJulyProfileData].sort((a, b) => b.avgViews - a.avgViews).slice(0, 10);
                window.avgViewsChartInstance = new Chart(avgViewsCtx, {
                    type: 'bar',
                    data: {
                        labels: sortedByAvgViews.map(p => formatClipLabel(p.name, 20)),
                        datasets: [{
                            label: 'Average Views per Clip',
                            data: sortedByAvgViews.map(p => p.avgViews),
                            backgroundColor: clipPerformanceChartColors.slice().reverse(),
                            borderColor: 'rgba(255, 255, 255, 0.2)',
                            borderWidth: 1
                        }]
                    },
                    options: { ...clipSharedTooltipConfig,
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { ...clipSharedTooltipConfig.plugins,
                            legend: { display: false },
                            title: { display: true, text: 'Top 10 Profiles by Average Views per Clip', font: { size: 16 }, color: clipPerformancePalette.blueDark }
                        },
                        scales: {
                            x: { title: { display: true, text: 'Average Views per Clip' }, grid: { color: '#e5e7eb' } },
                            y: { grid: { display: false } }
                        }
                    }
                });

                // New chart for Low 5 Titles by Average Views
                const sortedByAvgViewsAsc = [...thirdPartyJulyProfileData].sort((a, b) => a.avgViews - b.avgViews).slice(0, 5);
                window.lowAvgViewsChartInstance = new Chart(lowAvgViewsCtx, {
                    type: 'bar',
                    data: {
                        labels: sortedByAvgViewsAsc.map(p => formatClipLabel(p.name, 20)),
                        datasets: [{
                            label: 'Average Views per Clip',
                            data: sortedByAvgViewsAsc.map(p => p.avgViews),
                            backgroundColor: [clipPerformancePalette.redMid, clipPerformancePalette.orangeDark, clipPerformancePalette.yellowMid, clipPerformancePalette.yellowLight, clipPerformancePalette.blueLight], // A gradient from red to light blue
                            borderColor: 'rgba(255, 255, 255, 0.2)',
                            borderWidth: 1
                        }]
                    },
                    options: { ...clipSharedTooltipConfig,
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { ...clipSharedTooltipConfig.plugins,
                            legend: { display: false },
                            title: { display: true, text: 'Low 5 Profiles by Average Views per Clip', font: { size: 16 }, color: clipPerformancePalette.blueDark }
                        },
                        scales: {
                            x: { title: { display: true, text: 'Average Views per Clip' }, grid: { color: '#e5e7eb' } },
                            y: { grid: { display: false } },
                        },
                        onClick: (evt, elements) => { // New onClick for lowAvgViewsChartInstance
                            showDebugMessage("Chart click event triggered on July Low Avg Views Chart.");
                            if (elements.length > 0) {
                                const dataIndex = elements[0].index;
                                const clickedTitleRaw = window.lowAvgViewsChartInstance.data.labels[dataIndex];
                                // Get the original title name from the sorted data array
                                const originalTitleObject = sortedByAvgViewsAsc[dataIndex];
                                const originalTitleName = originalTitleObject ? originalTitleObject.name : (Array.isArray(clickedTitleRaw) ? clickedTitleRaw.join(' ') : clickedTitleRaw);
                                
                                showDebugMessage("Clicked title on July Low Avg Views Chart: " + originalTitleName);

                                if (allTitlesShortsData[originalTitleName]) {
                                    showDebugMessage(`Calling showShortsModal for ${originalTitleName} from July Low Avg Views Chart click.`);
                                    showShortsModal(originalTitleName, allTitlesShortsData[originalTitleName]);
                                } else {
                                    showDebugMessage(`No specific shorts data found for ${originalTitleName}. Showing empty modal.`);
                                    showShortsModal(originalTitleName, []); // Show empty modal
                                }
                            } else {
                                showDebugMessage("No element clicked on July Low Avg Views Chart.");
                            }
                        }
                    }
                });
                showDebugMessage("Third Party July Charts initialized.");
            }

            // Function to populate the Low 5 Titles table
            function populateLowTitlesTable() {
                const tableBody = document.getElementById('lowTitlesTableBody');
                if (!tableBody) return;
                tableBody.innerHTML = ''; // Clear existing rows

                const low5Titles = [...thirdPartyJulyProfileData].sort((a, b) => a.avgViews - b.avgViews).slice(0, 5);

                // Create rows with loading indicators for reasons
                low5Titles.forEach(item => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td class="px-4 py-2 whitespace-nowrap">${item.name}</td>
                        <td class="px-4 py-2 whitespace-nowrap">${item.clips}</td>
                        <td class="px-4 py-2 whitespace-nowrap">${item.totalViews.toLocaleString()}</td>
                        <td class="px-4 py-2 whitespace-nowrap">${item.avgViews.toFixed(1)}</td>
                    `;
                    tableBody.appendChild(row);
                });
            }

            // Function to populate the new Top 10 Total Views table
            function populateTopTotalViewsTable() {
                const tableBody = document.getElementById('topTotalViewsTableBody');
                if (!tableBody) return;
                tableBody.innerHTML = ''; // Clear existing rows

                const top10TotalViews = [...thirdPartyJulyProfileData].sort((a, b) => b.totalViews - a.totalViews).slice(0, 10);

                top10TotalViews.forEach(item => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td class="px-4 py-2 whitespace-nowrap">${item.name}</td>
                        <td class="px-4 py-2 whitespace-nowrap">${item.clips}</td>
                        <td class="px-4 py-2 whitespace-nowrap">${item.totalViews.toLocaleString()}</td> <!-- Added Total Views -->
                        <td class="px-4 py-2 whitespace-nowrap">${item.avgViews.toFixed(1)}</td>
                    `;
                    tableBody.appendChild(row);
                });
            }

            // Event listener for the new "More Details" button for Top Total Views
            const showTopTotalViewsTableBtn = document.getElementById('showTopTotalViewsTableBtn');
            const topTotalViewsTableContainer = document.getElementById('topTotalViewsTableContainer');

            if (showTopTotalViewsTableBtn && topTotalViewsTableContainer) {
                showTopTotalViewsTableBtn.addEventListener('click', () => {
                    topTotalViewsTableContainer.classList.toggle('hidden');
                    showDebugMessage("Toggled Top Total Views Table visibility.");
                });
            }

            // Event listener for the new "More Details" button for Low Avg Views
            const showLowAvgViewsTableBtn = document.getElementById('showLowAvgViewsTableBtn');
            const lowTitlesTableContainer = document.getElementById('lowTitlesTableContainer');

            if (showLowAvgViewsTableBtn && lowTitlesTableContainer) {
                showLowAvgViewsTableBtn.addEventListener('click', () => {
                    lowTitlesTableContainer.classList.toggle('hidden');
                    showDebugMessage("Toggled Low Avg Views Table visibility.");
                });
            }

            // Modal functionality
            const shortsModal = document.getElementById('shortsModal');
            const closeModalBtn = document.getElementById('closeModalBtn');
            const modalTableBody = document.getElementById('modalTableBody');
            const modalTitle = document.getElementById('modalTitle');
            const debugMessageDiv = document.getElementById('debugMessage');

            function showDebugMessage(message) {
                debugMessageDiv.textContent = message;
                debugMessageDiv.classList.add('show');
                debugMessageDiv.classList.remove('hidden');
                setTimeout(() => {
                    debugMessageDiv.classList.remove('show');
                    debugMessageDiv.classList.add('hidden');
                }, 5000); // Message disappears after 5 seconds
            }

            function showShortsModal(title, data) {
                showDebugMessage(`Attempting to open ${title} shorts modal...`);
                modalTitle.textContent = `${title} Shorts Views`;
                modalTableBody.innerHTML = ''; // Clear previous data

                if (data && data.length > 0) {
                    data.forEach(item => {
                        const viewsText = (typeof item.views === 'number') ? item.views.toLocaleString() : item.views;
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${item.title}</td>
                            <td>${viewsText}</td>
                        `;
                        modalTableBody.appendChild(row);
                    });
                } else {
                    const row = document.createElement('tr');
                    row.innerHTML = `<td colspan="2" class="text-center py-4 text-slate-500">No shorts data available for ${title}. Will be available soon!</td>`;
                    modalTableBody.appendChild(row);
                }

                shortsModal.classList.add('show');
                showDebugMessage("Modal 'show' class added.");
            }

            closeModalBtn.addEventListener('click', () => {
                showDebugMessage("Close modal button clicked.");
                shortsModal.classList.remove('show');
                showDebugMessage("Modal 'show' class removed.");
            });

            // Close modal when clicking outside of it
            shortsModal.addEventListener('click', (event) => {
                if (event.target === shortsModal) {
                    showDebugMessage("Clicked outside modal, closing.");
                    shortsModal.classList.remove('show');
                }
            });

            // --- July Specific Chart and Table Logic ---
            let julyAverageViewsChart;
            let julyRangeViewsChart;
            let julyDailyViewsChart;
            let julyTopTitlesViewsChart;
            let julyAvgViewsPerClipChart; // New chart instance for Avg Views Per Clip
            let julyLikesChart; // New chart instance for Likes

            const initializeJulyCharts = () => {
                showDebugMessage("Initializing July charts...");

                // Destroy existing July chart instances if they exist
                if (julyAverageViewsChart) julyAverageViewsChart.destroy();
                if (julyRangeViewsChart) julyRangeViewsChart.destroy();
                if (julyDailyViewsChart) julyDailyViewsChart.destroy();
                if (julyTopTitlesViewsChart) julyTopTitlesViewsChart.destroy();
                if (julyAvgViewsPerClipChart) julyAvgViewsPerClipChart.destroy(); // Destroy new chart
                if (julyLikesChart) julyLikesChart.destroy(); // Destroy new chart

                // Initialize July Overall Charts (Average and Range)
                const julyAvgCtx = document.getElementById('julyAverageViewsChart').getContext('2d');
                const julyAvgChartOptions = {
                    ...baseOptions,
                    onClick: chartClickHandler,
                    plugins: {
                        ...baseOptions.plugins,
                        tooltip: {
                            ...baseOptions.plugins.tooltip,
                            callbacks: {
                                label: function(context) {
                                    return `Avg. Views: ${context.parsed.y.toFixed(0)}K`;
                                }
                            }
                        }
                    }
                };
                julyAverageViewsChart = createChart(julyAvgCtx, 'bar', {
                    labels: processOverallData(julyDailyData).labels,
                    datasets: [{
                        label: 'Average Views',
                        data: processOverallData(julyDailyData).avgData,
                        backgroundColor: 'rgba(14, 165, 233, 0.6)',
                        borderColor: 'rgba(14, 165, 233, 1)',
                        borderWidth: 2,
                        borderRadius: 4,
                    }]
                }, julyAvgChartOptions);

                const julyRangeCtx = document.getElementById('julyRangeViewsChart').getContext('2d');
                const julyRangeChartOptions = {
                    ...baseOptions,
                    onClick: chartClickHandler,
                    scales: {
                        ...baseOptions.scales,
                        y: {
                            ...baseOptions.scales.y,
                            beginAtZero: false
                        }
                    },
                    plugins: {
                        ...baseOptions.plugins,
                        tooltip: {
                            ...baseOptions.plugins.tooltip,
                            callbacks: {
                                label: function(context) {
                                    const range = context.raw;
                                    return `Views Range: ${range[0]}K - ${range[1]}K`;
                                }
                            }
                        }
                    }
                };
                julyRangeViewsChart = createChart(julyRangeCtx, 'bar', {
                    labels: processOverallData(julyDailyData).labels,
                    datasets: [{
                        label: 'Viewership Range',
                        data: processOverallData(julyDailyData).rangeData,
                        backgroundColor: 'rgba(245, 158, 11, 0.6)',
                        borderColor: 'rgba(245, 158, 11, 1)',
                        borderWidth: 2,
                        borderRadius: 4,
                        borderSkipped: false,
                    }]
                }, julyRangeChartOptions);

                // Initialize July Daily Views Chart
                const julyDailyCtx = document.getElementById('julyDailyViewsChart').getContext('2d');
                const julyDailyChartOptions = {
                    ...baseOptions,
                    onClick: chartClickHandler,
                    plugins: {
                        ...baseOptions.plugins,
                        tooltip: {
                            ...baseOptions.plugins.tooltip,
                            callbacks: {
                                label: function(context) {
                                    return `Daily Views: ${context.parsed.y.toFixed(0)}K`;
                                }
                            }
                        }
                    },
                    scales: {
                        ...baseOptions.scales,
                        x: {
                            ...baseOptions.scales.x,
                            ticks: {
                                color: '#64748b',
                                maxRotation: 45,
                                minRotation: 45
                            }
                        }
                    }
                };
                julyDailyViewsChart = createChart(julyDailyCtx, 'bar', {
                    labels: [],
                    datasets: [{
                        label: 'Daily Views',
                        data: [],
                        backgroundColor: 'rgba(16, 185, 129, 0.6)',
                        borderColor: 'rgba(16, 185, 129, 1)',
                        borderWidth: 2,
                        borderRadius: 4,
                    }]
                }, julyDailyChartOptions);

                // Initialize July Top Titles Views Chart (Total Views)
                const julyTopTitlesCtx = document.getElementById('julyTopTitlesViewsChart').getContext('2d');
                const julyTopTitlesChartOptions = {
                    ...baseOptions,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true,
                            grid: { color: '#e2e8f0' },
                            ticks: {
                                color: '#64748b',
                                callback: function(value) { return (value / 1000000) + 'M'; }
                            },
                            title: { display: true, text: 'Total Views', color: '#475569', font: { weight: 'semibold' } }
                        },
                        y: {
                            grid: { display: false },
                            ticks: { color: '#64748b' }
                        }
                    },
                    plugins: {
                        ...baseOptions.plugins,
                        tooltip: {
                            ...baseOptions.plugins.tooltip,
                            callbacks: {
                                label: function(context) { return `Total Views: ${context.parsed.x / 1000000}M`; }
                            }
                        }
                    },
                    barThickness: 30,
                    categoryPercentage: 0.8,
                    barPercentage: 0.9,
                    onClick: (evt, elements) => {
                        showDebugMessage("Chart click event triggered on July Top Titles Views Chart.");
                        if (elements.length > 0) {
                            const dataIndex = elements[0].index;
                            const clickedTitle = julyTopTitlesViewsChart.data.labels[dataIndex];
                            showDebugMessage("Clicked title on July Top Titles Views Chart: " + clickedTitle);
                            const titleData = julyTopTitlesData.find(t => t.title === clickedTitle);
                            if (titleData) {
                                // For now, no specific modal for these, just a debug message
                                showDebugMessage(`Details for ${titleData.title}: Views=${titleData.views}, Likes=${titleData.likes}, AvgViewsPerClip=${titleData.avgViewsPerClip}`);
                            }
                        }
                    }
                };

                julyTopTitlesViewsChart = createChart(julyTopTitlesCtx, 'bar', {
                    labels: julyTopTitlesData.map(item => item.title),
                    datasets: [{
                        label: 'Total Views',
                        data: julyTopTitlesData.map(item => item.views),
                        backgroundColor: 'rgba(79, 70, 229, 0.6)',
                        borderColor: 'rgba(79, 70, 229, 1)',
                        borderWidth: 2,
                        borderRadius: 4,
                    }]
                }, julyTopTitlesChartOptions);

                // Initialize July Average Views Per Clip Chart
                const julyAvgViewsPerClipCtx = document.getElementById('julyAvgViewsPerClipChart').getContext('2d');
                const julyAvgViewsPerClipChartOptions = {
                    ...baseOptions,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true,
                            grid: { color: '#e2e8f0' },
                            ticks: {
                                color: '#64748b',
                                callback: function(value) { return value.toLocaleString(); }
                            },
                            title: { display: true, text: 'Average Views Per Clip', color: '#475569', font: { weight: 'semibold' } }
                        },
                        y: {
                            grid: { display: false },
                            ticks: { color: '#64748b' }
                        }
                    },
                    plugins: {
                        ...baseOptions.plugins,
                        tooltip: {
                            ...baseOptions.plugins.tooltip,
                            callbacks: {
                                label: function(context) { return `Avg. Views/Clip: ${context.parsed.x.toLocaleString()}`; }
                            }
                        }
                    },
                    barThickness: 30,
                    categoryPercentage: 0.8,
                    barPercentage: 0.9,
                    onClick: (evt, elements) => {
                        showDebugMessage("Chart click event triggered on July Avg Views Per Clip Chart.");
                        if (elements.length > 0) {
                            const dataIndex = elements[0].index;
                            const clickedTitle = julyAvgViewsPerClipChart.data.labels[dataIndex];
                            showDebugMessage("Clicked title on July Avg Views Per Clip Chart: " + clickedTitle);
                            const titleData = julyTopTitlesData.find(t => t.title === clickedTitle);
                            if (titleData) {
                                showDebugMessage(`Details for ${titleData.title}: Views=${titleData.views}, Likes=${titleData.likes}, AvgViewsPerClip=${titleData.avgViewsPerClip}`);
                            }
                        }
                    }
                };

                julyAvgViewsPerClipChart = createChart(julyAvgViewsPerClipCtx, 'bar', {
                    labels: julyTopTitlesData.map(item => item.title),
                    datasets: [{
                        label: 'Average Views Per Clip',
                        data: julyTopTitlesData.map(item => item.avgViewsPerClip),
                        backgroundColor: 'rgba(234, 88, 12, 0.6)', // orange-600
                        borderColor: 'rgba(234, 88, 12, 1)',
                        borderWidth: 2,
                        borderRadius: 4,
                    }]
                }, julyAvgViewsPerClipChartOptions);

                // Initialize July Likes Chart
                const julyLikesCtx = document.getElementById('julyLikesChart').getContext('2d');
                const julyLikesChartOptions = {
                    ...baseOptions,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true,
                            grid: { color: '#e2e8f0' },
                            ticks: {
                                color: '#64748b',
                                callback: function(value) { return value.toLocaleString(); }
                            },
                            title: { display: true, text: 'Total Likes', color: '#475569', font: { weight: 'semibold' } }
                        },
                        y: {
                            grid: { display: false },
                            ticks: { color: '#64748b' }
                        }
                    },
                    plugins: {
                        ...baseOptions.plugins,
                        tooltip: {
                            ...baseOptions.plugins.tooltip,
                            callbacks: {
                                label: function(context) { return `Total Likes: ${context.parsed.x.toLocaleString()}`; }
                            }
                        }
                    },
                    barThickness: 30,
                    categoryPercentage: 0.8,
                    barPercentage: 0.9,
                    onClick: (evt, elements) => {
                        showDebugMessage("Chart click event triggered on July Likes Chart.");
                        if (elements.length > 0) {
                            const dataIndex = elements[0].index;
                            const clickedTitle = julyLikesChart.data.labels[dataIndex];
                            showDebugMessage("Clicked title on July Likes Chart: " + clickedTitle);
                            const titleData = julyTopTitlesData.find(t => t.title === clickedTitle);
                            if (titleData) {
                                showDebugMessage(`Details for ${titleData.title}: Views=${titleData.views}, Likes=${titleData.likes}, AvgViewsPerClip=${titleData.avgViewsPerClip}`);
                            }
                        }
                    }
                };

                julyLikesChart = createChart(julyLikesCtx, 'bar', {
                    labels: julyTopTitlesData.map(item => item.title),
                    datasets: [{
                        label: 'Total Likes',
                        data: julyTopTitlesData.map(item => item.likes),
                        backgroundColor: 'rgba(6, 182, 212, 0.6)', // cyan-500
                        borderColor: 'rgba(6, 182, 212, 1)',
                        borderWidth: 2,
                        borderRadius: 4,
                    }]
                }, julyLikesChartOptions);

                showDebugMessage("July charts initialized.");
            };

            // Function to update July Top Titles Chart for a single title
            const displaySingleJulyTitleOnChart = (title, views) => {
                julyTopTitlesViewsChart.data.labels = [title];
                julyTopTitlesViewsChart.data.datasets[0].data = [views];
                julyTopTitlesViewsChart.update();

                julyAvgViewsPerClipChart.data.labels = [title];
                julyAvgViewsPerClipChart.data.datasets[0].data = [julyTopTitlesData.find(t => t.title === title).avgViewsPerClip];
                julyAvgViewsPerClipChart.update();

                julyLikesChart.data.labels = [title];
                julyLikesChart.data.datasets[0].data = [julyTopTitlesData.find(t => t.title === title).likes];
                julyLikesChart.update();
            };

            // Function to display all July titles on the chart
            const displayAllJulyTitlesOnChart = () => {
                julyTopTitlesViewsChart.data.labels = julyTopTitlesData.map(item => item.title);
                julyTopTitlesViewsChart.data.datasets[0].data = julyTopTitlesData.map(item => item.views);
                julyTopTitlesViewsChart.update();

                julyAvgViewsPerClipChart.data.labels = julyTopTitlesData.map(item => item.title);
                julyAvgViewsPerClipChart.data.datasets[0].data = julyTopTitlesData.map(item => item.avgViewsPerClip);
                julyAvgViewsPerClipChart.update();

                julyLikesChart.data.labels = julyTopTitlesData.map(item => item.title);
                julyLikesChart.data.datasets[0].data = julyTopTitlesData.map(item => item.likes);
                julyLikesChart.update();
            };

            // Function to populate the Top Titles table - July
            const populateJulyTopTitlesTable = () => {
                const tableBody = document.getElementById('julyTopTitlesTableBody');
                if (!tableBody) return;
                tableBody.innerHTML = '';

                julyTopTitlesData.forEach(item => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td class="px-4 py-2 whitespace-nowrap">${item.rank}</td>
                        <td class="px-4 py-2 whitespace-nowrap">${item.title}</td>
                        <td class="px-4 py-2 whitespace-nowrap">${item.views.toLocaleString()}</td>
                        <td class="px-4 py-2 whitespace-nowrap">${item.likes.toLocaleString()}</td>
                        <td class="px-4 py-2 whitespace-nowrap">${item.avgViewsPerClip.toLocaleString()}</td>
                    `;
                    row.addEventListener('click', () => {
                        showDebugMessage("Table row click event triggered for: " + item.title + " (July Top Titles)");
                        displaySingleJulyTitleOnChart(item.title, item.views);
                    });
                    tableBody.appendChild(row);
                });
            };

            // Event listener for "Show All Titles" button - July
            const julyShowAllTitlesBtn = document.getElementById('julyShowAllTitlesBtn');
            if (julyShowAllTitlesBtn) {
                julyShowAllTitlesBtn.addEventListener('click', displayAllJulyTitlesOnChart);
            }

            // July Tab functionality for Overall Chart Type (Average vs. Range)
            const julyAvgBtn = document.getElementById('julyAvgBtn');
            const julyRangeBtn = document.getElementById('julyRangeBtn');
            const julyAvgChartContainer = document.getElementById('julyAvgChartContainer');
            const julyRangeChartContainer = document.getElementById('julyRangeChartContainer');

            if (julyAvgBtn && julyRangeBtn && julyAvgChartContainer && julyRangeChartContainer) {
                julyAvgBtn.addEventListener('click', () => {
                    julyAvgChartContainer.classList.remove('hidden');
                    julyRangeChartContainer.classList.add('hidden');
                    julyAvgBtn.classList.add('bg-white', 'text-sky-600', 'shadow-sm', 'font-semibold');
                    julyAvgBtn.classList.remove('text-slate-600', 'font-medium');
                    julyRangeBtn.classList.remove('bg-white', 'text-sky-600', 'shadow-sm', 'font-semibold');
                    julyRangeBtn.classList.add('text-slate-600', 'font-medium');
                });

                julyRangeBtn.addEventListener('click', () => {
                    julyRangeChartContainer.classList.remove('hidden');
                    julyAvgChartContainer.classList.add('hidden');
                    julyRangeBtn.classList.add('bg-white', 'text-sky-600', 'shadow-sm', 'font-semibold');
                    julyRangeBtn.classList.remove('text-slate-600', 'font-medium');
                    julyAvgBtn.classList.remove('bg-white', 'text-sky-600', 'shadow-sm', 'font-semibold');
                    julyAvgBtn.classList.add('text-slate-600', 'font-medium');
                });
            }

            // July Tab functionality for Weekly Daily Data
            const julyWeeklyDailyButtons = document.querySelectorAll('.july-weekly-daily-btn');
            const julyDailyChartSection = document.getElementById('julyDailyChartContainer');

            julyWeeklyDailyButtons.forEach(button => {
                button.addEventListener('click', () => {
                    julyWeeklyDailyButtons.forEach(btn => {
                        btn.classList.remove('bg-white', 'text-sky-600', 'shadow-sm', 'font-semibold');
                        btn.classList.add('text-slate-600', 'font-medium');
                    });
                    button.classList.add('bg-white', 'text-sky-600', 'shadow-sm', 'font-semibold');
                    button.classList.remove('text-slate-600', 'font-medium');

                    let selectedWeek = parseInt(button.id.replace('julyWeek', '').replace('DailyBtn', ''));
                    
                    if (julyDailyChartSection) {
                        julyDailyChartSection.classList.remove('hidden');
                    }

                    updateDailyViewsChart(julyDailyData, julyDailyViewsChart, selectedWeek);
                });
            });

            // July Main Tab functionality
            const julyMainTabButtons = document.querySelectorAll('.july-main-tab-btn');
            const julyContentSections = document.querySelectorAll('.july-content-section');

            julyMainTabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    julyMainTabButtons.forEach(btn => {
                        btn.classList.remove('bg-white', 'text-sky-600', 'shadow-sm', 'font-semibold');
                        btn.classList.add('text-slate-600', 'font-medium');
                    });

                    button.classList.add('bg-white', 'text-sky-600', 'shadow-sm', 'font-semibold');
                    button.classList.remove('text-slate-600', 'font-medium');

                    julyContentSections.forEach(section => {
                        section.classList.add('hidden');
                    });

                    const targetSectionId = button.dataset.target;
                    const sectionToShow = document.getElementById(targetSectionId);
                    if (sectionToShow) {
                        sectionToShow.classList.remove('hidden');
                        if (targetSectionId === 'july-dashboard-section') {
                            updateKPIs(julyDailyData, 'july'); // Update July KPIs when dashboard is shown
                            initializeJulyCharts();
                        } else if (targetSectionId === 'july-top-titles-section') {
                            populateJulyTopTitlesTable();
                            // Ensure charts are initialized and updated when visible
                            setTimeout(() => {
                                if (julyTopTitlesViewsChart) {
                                    julyTopTitlesViewsChart.resize();
                                    julyTopTitlesViewsChart.update();
                                }
                                if (julyAvgViewsPerClipChart) {
                                    julyAvgViewsPerClipChart.resize();
                                    julyAvgViewsPerClipChart.update();
                                }
                                if (julyLikesChart) {
                                    julyLikesChart.resize();
                                    julyLikesChart.update();
                                }
                            }, 100);
                        }
                    }
                });
            });

            // --- Week Comparison Chart Logic ---
            const initializeWeekComparisonChart = () => {
                showDebugMessage("Initializing Week Comparison Chart...");
                if (weekComparisonChart) {
                    weekComparisonChart.destroy();
                }

                // Data for comparison - CORRECTED SLICING
                const juneWeek1Data = fullDailyData.slice(0, 7); // Jun 1 - Jun 7
                const juneWeek2Data = fullDailyData.slice(7, 14); // Jun 8 - Jun 14
                const julyWeek1Data = julyDailyData.slice(0, 7); // Jun 30 - Jul 6
                const julyWeek2Data = julyDailyData.slice(7, 14); // Jul 7 - Jul 13

                // Calculate total views
                const calculateTotalViews = (data) => data.reduce((sum, item) => sum + item.views, 0);

                document.getElementById('juneWeek1TotalViews').textContent = calculateTotalViews(juneWeek1Data).toLocaleString();
                document.getElementById('juneWeek2TotalViews').textContent = calculateTotalViews(juneWeek2Data).toLocaleString();
                document.getElementById('julyWeek1TotalViews').textContent = calculateTotalViews(julyWeek1Data).toLocaleString();
                document.getElementById('julyWeek2TotalViews').textContent = calculateTotalViews(julyWeek2Data).toLocaleString();

                // Generate labels based on the actual dates for better clarity
                const generateLabels = (data) => data.map(d => `${d.date} (${d.day.substring(0, 3)})`);

                const labelsJuneW1 = generateLabels(juneWeek1Data);
                const labelsJuneW2 = generateLabels(juneWeek2Data);
                const labelsJulyW1 = generateLabels(julyWeek1Data);
                const labelsJulyW2 = generateLabels(julyWeek2Data);

                // Combine labels for the x-axis, ensuring they align or are clearly distinguishable
                // For a single chart, it's better to use generic "Day 1", "Day 2" or ensure date ranges are clear in legend
                // Let's stick to "Day 1", "Day 2" for simplicity on the x-axis, and rely on dataset labels for clarity.
                const commonLabels = ['Day 1', 'Day 2', 'Day 3', 'Day 4', 'Day 5', 'Day 6', 'Day 7'];


                const ctx = document.getElementById('weekComparisonChart').getContext('2d');
                weekComparisonChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: commonLabels, // Use generic labels for alignment
                        datasets: [
                            {
                                label: 'June Week 1 (Jun 1-7)',
                                data: juneWeek1Data.map(d => d.views),
                                borderColor: 'rgb(75, 192, 192)',
                                backgroundColor: 'rgba(75, 192, 192, 0.2)',
                                fill: false,
                                tension: 0.1
                            },
                            {
                                label: 'June Week 2 (Jun 8-14)',
                                data: juneWeek2Data.map(d => d.views),
                                borderColor: 'rgb(255, 99, 132)',
                                backgroundColor: 'rgba(255, 99, 132, 0.2)',
                                fill: false,
                                tension: 0.1
                            },
                            {
                                label: 'July Week 1 (Jun 30-Jul 6)',
                                data: julyWeek1Data.map(d => d.views),
                                borderColor: 'rgb(54, 162, 235)',
                                backgroundColor: 'rgba(54, 162, 235, 0.2)',
                                fill: false,
                                tension: 0.1
                            },
                            {
                                label: 'July Week 2 (Jul 7-13)',
                                data: julyWeek2Data.map(d => d.views),
                                borderColor: 'rgb(255, 205, 86)',
                                backgroundColor: 'rgba(255, 205, 86, 0.2)',
                                fill: false,
                                tension: 0.1
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top',
                                labels: {
                                    font: {
                                        size: 14
                                    }
                                }
                            },
                            title: {
                                display: true,
                                text: 'Daily Viewership: June vs. July (First Two Weeks)',
                                font: {
                                    size: 18,
                                    weight: 'bold'
                                },
                                color: '#1f2937'
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `${context.dataset.label}: ${context.parsed.y}K views`;
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                title: {
                                    display: true,
                                    text: 'Day of Week',
                                    color: '#475569'
                                },
                                ticks: {
                                    color: '#64748b'
                                }
                            },
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Views (in Thousands)',
                                    color: '#475569'
                                },
                                ticks: {
                                    color: '#64748b',
                                    callback: function(value) {
                                        return value + 'K';
                                    }
                                }
                            }
                        }
                    }
                });
                showDebugMessage("Week Comparison Chart initialized.");
            };


            // Initial updates for June
            updateKPIs(fullDailyData);
            populateTopTitlesTable(); // Populate the table on load
            showDebugMessage("Dashboard Initialized!"); // Confirm script execution
            // Do NOT call updateDailyViewsChart('all') here, as we want it hidden initially.
        });
    </script>
</body>
</html>
�
